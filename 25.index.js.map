{"version":3,"sources":["webpack://rock-raiders-web/./src/core/Util.ts","webpack://rock-raiders-web/./src/core/ImageHelper.ts","webpack://rock-raiders-web/./src/params.ts","webpack://rock-raiders-web/./src/resource/FlhParser.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/BitmapWithPalette.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/EncodingHelper.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/CfgFileParser.ts","webpack://rock-raiders-web/./src/cfg/LevelObjectiveTextEntry.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/ObjectiveTextParser.ts","webpack://rock-raiders-web/./src/game/model/job/PriorityIdentifier.ts","webpack://rock-raiders-web/./src/resource/wadworker/WorkerMessageType.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/WadParser.ts","webpack://rock-raiders-web/./src/cfg/BaseConfig.ts","webpack://rock-raiders-web/./src/cfg/ConfigColor.ts","webpack://rock-raiders-web/./src/cfg/ObjectiveImageCfg.ts","webpack://rock-raiders-web/./src/cfg/LevelsCfg.ts","webpack://rock-raiders-web/./src/cfg/MenuCycleItemCfg.ts","webpack://rock-raiders-web/./src/cfg/MenuLabelItemCfg.ts","webpack://rock-raiders-web/./src/cfg/CfgHelper.ts","webpack://rock-raiders-web/./src/cfg/MenuSliderItemCfg.ts","webpack://rock-raiders-web/./src/cfg/MenuEntryCfg.ts","webpack://rock-raiders-web/./src/cfg/MenuCfg.ts","webpack://rock-raiders-web/./src/cfg/RewardCfg.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/RonFileParser.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadAssetRegistry.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadFile.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadLoader.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadUtil.ts","webpack://rock-raiders-web/./src/resource/wadworker/parser/NerpMsgParser.ts","webpack://rock-raiders-web/./src/cfg/BuildingEntityStats.ts","webpack://rock-raiders-web/./src/cfg/GameStatsCfg.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadWorkerMessage.ts","webpack://rock-raiders-web/./src/resource/wadworker/WadWorker.ts"],"names":["getPath","url","strUrl","toString","replace","startsWith","substring","lastInd","lastIndexOf","getFilename","iGet","obj","keys","forEach","keyname","Object","filter","key","toLowerCase","map","setPixel","imgData","x","y","r","g","b","a","n","width","data","Array","prototype","add","element","this","indexOf","push","remove","index","splice","removeLast","lastIndex","last","length","undefined","count","callback","counter","e","partition","left","right","random","max","min","Math","ceil","floor","getRandomInclusive","Map","getOrUpdate","updateCallback","value","get","set","String","equalsIgnoreCase","other","round","FlhParser","dataView","fileLength","flicFileType","lengthFrames","frames","height","depth","offsetFirstFrame","flhContent","DataView","parseHeader","parseChunks","getDWord","getWord","console","warn","frameIndex","chunkStart","chunkLength","chunkType","chunkDataView","buffer","slice","parseFrameType","toUpperCase","seg","offset","numChunks","getUint16","len","getUint32","parseDtaBrun","parseDeltaFlc","ImageData","w","repeat","getInt8","i","getARGBFrom555RGB","res","numLines","linesDone","packCount","opcode","getInt16","opType","abs","j","rgb","HeaderTypes","BmpDecoder","toRGBA","bufferView","byteOffset","byteLength","bottomUp","flag","fromCharCode","pos","Error","locRed","locGreen","locBlue","locAlpha","parseRGBA","fileSize","readUInt32LE","reserved1","reserved2","headerSize","planes","bitPP","compression","rawSize","hr","vr","colors","importantColors","maskAlpha","maskRed","maskGreen","maskBlue","BITMAP_INFO_HEADER","BITMAP_V2_INFO_HEADER","BITMAP_V3_INFO_HEADER","BITMAP_V4_HEADER","BITMAP_V5_HEADER","palette","blue","green","red","quad","coloShift","maskRedR","maskGreenR","maskBlueR","maskAlphaR","shiftedMaskRedL","shiftedMaskGreenL","shiftedMaskBlueL","shiftedMaskAlphaL","shiftRed","shiftGreen","shiftBlue","shiftAlpha","maskColor","Uint8Array","bit1","bit4","bit8","bit16","bit24","bit32","xLen","mode","padding","lastLine","scanImage","line","location","fill","lowNibble","lines","c","setPixelData","first4","last4","loc","px","processPixel","call","rgbIndex","BitmapWithPalette","decoder","super","Uint8ClampedArray","alphaIndex","alphaColor","encodeChar","CfgFileParser","result","ancestry","activeObject","isComment","parsingState","seek","charCode","charStr","pop","parsed","parseValue","hasOwnProperty","stack","val","isArray","sub","values","levelConf","textureSet","dependencies","flatDeps","d","reduce","array","splitShrink","sep","split","num","Number","isNaN","lVal","includes","LevelObjectiveTextEntry","ObjectiveTextParser","txtFileContent","state","PARSING_STATE","DROP","currentLevel","code","char","KEY","lLine","OBJECTIVE","FAILURE","COMPLETION","CRYSTAL_FAILURE","charCodeAt","objective","failure","completion","crystalFailure","PriorityIdentifier","WorkerMessageType","WadParser","level","row","objectList","currentObject","trim","objectStartMatch","match","drivingMatch","driving","parseFloat","BaseConfig","config","cfgObj","cfgKey","lCfgKeyName","some","objKey","assignValue","constructor","name","cfgValue","currentValue","currentIsArray","parsedValue","parsedIsArray","ConfigColor","ObjectiveImageCfg","filename","LevelsCfg","levelsByName","levelKey","LevelEntryCfg","fullName","endGameAvi1","endGameAvi2","allowRename","recallOLObjects","generateSpiders","video","disableEndTeleport","disableStartTeleport","emergeTimeOut","boulderAnimation","noMultiSelect","noAutoEat","disableToolTipSound","blockSize","digDepth","roughLevel","roofHeight","useRoof","selBoxHeight","fpRotLightRGB","fogColourRGB","highFogColourRGB","fogRate","fallinMultiplier","numberOfLandSlidesTillCaveIn","noFallins","oxygenRate","surfaceMap","predugMap","terrainMap","emergeMap","erodeMap","fallinMap","blockPointersMap","cryOreMap","pathMap","noGather","rockFallStyle","emergeCreature","safeCaverns","seeThroughWalls","oListFile","ptlFile","nerpFile","nerpMessageFile","objectiveText","objectiveImage640x480","erodeTriggerTime","erodeErodeTime","erodeLockTime","nextLevel","levelLinks","frontEndX","frontEndY","frontEndOpen","priorities","reward","menuBMP","setFromCfg","endsWith","LevelPrioritiesEntryConfig","LevelRewardConfig","enabled","enable","modifier","importance","quota","LevelRewardImportanceConfig","LevelRewardQuotaConfig","crystals","timer","caverns","constructions","oxygen","figures","MenuCycleItemCfg","actionName","description","two","labelOff","labelOn","MenuLabelItemCfg","label","target","join","parseLabel","imgNormal","imgHover","imgPressed","tooltip","log","MenuSliderItemCfg","imgOff","imgOn","imgLeft","imgRight","btnRightNormal","btnLeftNormal","btnRightHover","btnLeftHover","MenuEntryCfg","title","position","menuFont","loFont","hiFont","itemCount","menuImage","autoCenter","displayTitle","overlays","playRandom","itemsLabel","itemsSlider","itemsCycle","anchored","canScroll","lActionName","MenuCfg","menuCount","menus","RewardCfg","display","wallpaper","images","texts","boxImages","fonts","flics","scrollSpeed","centreText","vertSpacing","backFont","font","titleFont","saveButton","advanceButton","completeText","failedText","quitText","textPos","imgConf","RewardImageCfg","RewardTextCfg","RewardFontsCfg","filePath","text","ore","diggable","rockMonsters","score","RonFileParser","content","l","indDoubleSlash","indComment","v","root","parseObj","start","lv","WadAssetRegistry","wadLoader","mainConf","addAssetFolder","loadFontImageAsset","loadAlphaImageAsset","wad0File","filterEntryNames","assetPath","addAsset","loadFlhAsset","addMenuWithAssets","loadObjectiveTexts","addAlphaImageFolder","loadWadImageAsset","loadNerpAsset","levelsCfg","onAssetLoaded","bmpName","loadMapAsset","loadObjectListAsset","loadNerpMsg","addTextureFolder","upgradeTypes","uType","addMeshObjects","buildingTypes","bType","addAnimatedEntity","rockMonsterTypes","mType","vehicleTypes","vType","loadLWOFile","loadWadTexture","addLWSFile","miscObjects","rewardCfg","imgPath","img","sndPathToKeys","samplesConf","sndKey","sndPath","sndKeys","loadWavAsset","basePath","aeFilepath","hasEntry","aeSharedFilepath","lwsFilepath","lwsSharedFilepath","lwoFilepath","lwoSharedFilepath","aeFile","getEntryText","cfgRoot","parse","path","wheelMeshName","polyType","cfgPoly","file","extractLwoFiles","lwoFile","objLine","folderPath","menuImageAlpha","menuCfg","method","optional","sfxKeys","bind","WadFile","entryIndexByName","fLength","fStart","debug","Int8Array","apply","numberOfEntries","getInt32","bufferStart","entryName","getEntryBuffer","getEntryData","regexStr","regex","RegExp","entry","WadLoader","wad1File","assetIndex","totalResources","assetRegistry","onMessage","msg","onInitialLoad","onLoadDone","loadingTimeSeconds","decode","alphaIndexMatch","assetNames","parseInt","applyAlphaByIndex","arr","grayscaleToGreen","applyAlpha","nrnName","wad0Data","wad1Data","parseNerpMsgFile","msg1","m1","txt","snd","wadData","isWad0File","txt0Match","txt1Match","sndMatch","numericNameToNumber","digits","one","three","four","five","six","seven","eight","nine","tens","twenty","thirty","forty","number","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","eightteen","digitName","parseNerpMessages","txtContent","parseObjectiveTextFile","error","parseMap","parseObjectList","lwoContent","promises","that","asset","Promise","resolve","assetObj","all","then","Date","getTime","startTime","toFixed","onCacheMiss","_onerror","openLocalCache","objectStore","request1","onerror","onsuccess","prop","request2","startLoadingProcess","wad0Url","wad1Url","loadWadFile","wadFiles","put","fetch","response","ok","arrayBuffer","wadFile","parseWadFile","catch","onopen","request","indexedDB","open","onupgradeneeded","db","objectStoreNames","contains","deleteObjectStore","createObjectStore","transaction","cfg","registerAllAssets","size","loadAssetsParallel","BuildingEntityStats","Levels","SelfPowered","PowerBuilding","PickSphere","TrainDynamite","CostOre","CostCrystal","OxygenCoef","EngineSound","GameStatsCfg","Pilot","RouteSpeed","SoilDrillTime","LooseDrillTime","MedDrillTime","HardDrillTime","SeamDrillTime","UpgradeTime","CollRadius","CollHeight","TrackDist","SingleWidthDig","RepairValue","SurveyRadius","Drillsound","Drillfadesound","RestPercent","EnergyDecayRate","CanClearRubble","NumOfToolsCanCarry","CrossLand","RubbleCoef","PathCoef","RouteAvoidance","UseLegoManTeleporter","AwarenessRange","CanStrafe","EnterToolStore","ShowHealthBar","RockMonster","AlertRadius","HealthDecayRate","CanScare","CarryMinHealth","PainThreshold","StampRadius","AttackRadius","CanSteal","GrabMinifigure","BumpDamage","AttackPaths","SplitOnZeroHealth","CanBeHitByFence","Capacity","CanBeShotAt","CanFreeze","FreezerTime","FreezerDamage","CanLaser","LaserDamage","CanPush","PusherDist","PusherDamage","WakeRadius","ScaredByBigBangs","RemoveReinforcement","SmallSpider","RandomMove","RandomEnterWall","CauseSlip","DontShowDamage","DontShowOnRadar","Bat","randomMoveTime","Flocks","FlocksDebug","FlocksSmooth","FlocksSize","FlocksTurn","FlocksSpeed","FlocksTightness","FlocksGoalUpdate","FlocksRandomness","FlocksHeight","CrossWater","CrossLava","TinyRM","ScaredByPlayer","TinyIM","Slug","UseHoles","DrainPower","LavaMonster","IceMonster","Hoverboard","CanBeDriven","UseSmallTeleporter","UpgradeCostOre","UpgradeCostStuds","SmallHeli","Smallmlp","Tracker","CanDoubleSelect","SmallCat","UseWaterTeleporter","MaxCarry","GetInAtLand","GetOutAtLand","TakeCarryingDrivers","SmallDigger","VehicleCanBeCarried","SmallTruck","CarryStart","Bulldozer","UseBigTeleporter","InvisibleDriver","WalkerDigger","DrillSound","DrillFadeSound","LargeDigger","LargeCat","ClassAsLarge","CarryVehicles","LargeHeli","LargeMLP","Barracks","CostRefinedOre","SnaxULike","TrainDriver","CrystalDrain","DamageCausesCallToArms","Powerstation","ProcessCrystal","OreRefinery","ProcessOre","TeleportPad","SmallTeleporter","ManTeleporter","TrainPilot","TeleportBIG","BigTeleporter","Docks","WaterEntrances","WaterTeleporter","TrainSailor","Toolstation","ToolStore","StoreObjects","FunctionCoef","GunStation","Geodome","TrainScanner","Upgrade","UpgradeBuilding","TrainRepair","PowerCrystal","ProcessedOre","Ore","Boulder","Pusher","Freezer","LaserShot","ColRadius","ElectricFence","Path","WadWorkerMessage","type","MSG","CFG","stats","ASSET","DONE","worker","self","postMessage","assetMessage","addEventListener","event","createTextMessage","createCfgLoaded","createAssetLoaded","createLoadDone","loadWadFiles","wad0FileUrl","wad1FileUrl","startWithCachedFiles","CACHE_MISS"],"mappings":"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","file":"25.index.js","sourcesContent":["export function getPath(url: string): string {\n    if (!url) return url\n    let strUrl = url.toString().replace(/\\\\/g, '/')\n    if (strUrl.startsWith('/')) strUrl = strUrl.substring(1)\n    const lastInd = strUrl.lastIndexOf('/')\n    strUrl = strUrl.substring(0, lastInd + 1)\n    if (strUrl.startsWith('/')) strUrl = strUrl.substring(1)\n    return strUrl\n}\n\nexport function getFilename(url: string): string {\n    if (!url) return url\n    let strUrl = url.toString().replace(/\\\\/g, '/')\n    if (strUrl.startsWith('/')) strUrl = strUrl.substring(1)\n    const lastInd = strUrl.lastIndexOf('/')\n    return strUrl.substring(lastInd + 1)\n}\n\nexport function iGet(obj, ...keys: string[]): any {\n    keys.forEach((keyname) => {\n        obj = Object.keys(obj)\n            .filter((key) => key.toLowerCase() === keyname.toLowerCase())\n            .map((key) => obj[key])\n        obj = obj ? obj[0] : obj\n    })\n    return obj\n}\n\nexport function decodeString(data) {\n    return new TextDecoder().decode(data).replace(/\\0/g, '')\n}\n\nexport function decodeFilepath(data) {\n    return decodeString(data).replace(/\\\\/g, '/')\n}\n\nexport function getRandomInclusive(min, max) {\n    min = Math.ceil(min)\n    max = Math.floor(max)\n    return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nexport function getRandom(max) {\n    return getRandomInclusive(0, max)\n}\n\nexport function getRandomSign() {\n    return -1 + getRandomInclusive(0, 1) * 2\n}\n\nexport function clearTimeoutSafe(timeout: NodeJS.Timeout) {\n    if (timeout) clearTimeout(timeout)\n    return null\n}\n\nexport function clearIntervalSafe(interval: NodeJS.Timeout) {\n    if (interval) clearInterval(interval)\n    return null\n}\n\ndeclare global {\n\n    interface Array<T> {\n        add(element: T): void\n\n        remove(element: T): void\n\n        removeLast(element: T): void\n\n        last(): T\n\n        count(callback: (element: T) => boolean): number\n\n        partition(filter: (element: T) => boolean): [T[], T[]]\n\n        random(): T\n    }\n\n    interface Map<K, V> {\n        getOrUpdate(key: K, updateCallback: () => V): V\n    }\n\n    interface String {\n        equalsIgnoreCase(other: string): boolean\n    }\n\n}\n\nArray.prototype.add = function <T>(element: T): void {\n    const index = this.indexOf(element)\n    if (index === -1) this.push(element)\n}\n\nArray.prototype.remove = function <T>(element: T): void {\n    const index = this.indexOf(element)\n    if (index !== -1) this.splice(index, 1)\n}\n\nArray.prototype.removeLast = function <T>(element: T): void {\n    const lastIndex = this.indexOf(element)\n    if (lastIndex !== -1) this.splice(lastIndex, 1)\n}\n\nArray.prototype.last = function <T>(): T {\n    return this.length > 0 ? this[this.length - 1] : undefined\n}\n\nArray.prototype.count = function <T>(callback: (element: T) => boolean): number {\n    let counter = 0\n    this.forEach((e) => callback(e) && counter++)\n    return counter\n}\n\nArray.prototype.partition = function <T>(filter: (element: T) => boolean): [T[], T[]] {\n    const left: T[] = [], right: T[] = []\n    this.forEach((a) => filter(a) ? left.push(a) : right.push(a))\n    return [left, right]\n}\n\nArray.prototype.random = function <T>(): T {\n    if (!this.length) return undefined\n    return this[getRandom(this.length - 1)]\n}\n\n// noinspection JSUnusedGlobalSymbols\nMap.prototype.getOrUpdate = function <K, V>(key: K, updateCallback: () => V): V {\n    let value = this.get(key)\n    if (value === undefined) {\n        value = updateCallback()\n        this.set(key, value)\n    }\n    return value\n}\n\nString.prototype.equalsIgnoreCase = function (other: string): boolean {\n    return this.toLowerCase() === other?.toLowerCase()\n}\n","/**\n * creates a new context with the specified dimensions.\n * @param width: the desired width of the new context\n * @param height: the desired height of the new context\n * @returns RenderingContext the newly created canvas\n */\nexport function createContext(width, height): SpriteContext {\n    if (width < 1 || height < 1) {\n        console.error('Can\\'t create context with size ' + width + ' x ' + height)\n        return createDummyContext(64, 64)\n    }\n    let canvas\n    if (typeof document !== 'undefined') {\n        canvas = document.createElement('canvas')\n        canvas.setAttribute('width', width)\n        canvas.setAttribute('height', height)\n    } else {\n        canvas = new OffscreenCanvas(width, height)\n    }\n    const context = canvas.getContext('2d')\n    context.width = width\n    context.height = height\n    return context\n}\n\n/**\n * This method is intended to increase stability by providing an (ugly) placeholder image in case the right one is missing\n * @param width: expected width of the original image\n * @param height: expected height of the original image\n */\nexport function createDummyContext(width, height): SpriteContext {\n    const result = createContext(width, height)\n    for (let y = 0; y < height; y += 16) {\n        for (let x = 0; x < width; x += 16) {\n            if (x / 16 % 2 === y / 16 % 2) {\n                result.fillStyle = 'rgb(0,255,255)'\n            } else {\n                result.fillStyle = 'rgb(255,0,255)'\n            }\n            result.fillRect(x, y, 16, 16)\n        }\n    }\n    return result\n}\n\nexport function createDummyImgData(width, height): ImageData {\n    const result = new ImageData(width, height)\n    for (let y = 0; y < height; y += 16) {\n        for (let x = 0; x < width; x += 16) {\n            const e = x / 16 % 2 === y / 16 % 2\n            for (let px = x; px < x + 16; px++) {\n                for (let py = y; py < y + 16; py++) {\n                    setPixel(result, px, py, e ? 0 : 255, e ? 255 : 0, 255)\n                }\n            }\n        }\n    }\n    return result\n}\n\nexport function setPixel(imgData, x, y, r, g, b, a = 255): void {\n    const n = (y * imgData.width + x) * 4\n    imgData.data[n] = r\n    imgData.data[n + 1] = g\n    imgData.data[n + 2] = b\n    imgData.data[n + 3] = a\n}\n\nexport function getPixel(imgData, x, y): { r: number, g: number, b: number, a: number } {\n    const n = (y * imgData.width + x) * 4\n    return {r: imgData.data[n], g: imgData.data[n + 1], b: imgData.data[n + 2], a: imgData.data[n + 3]}\n}\n","export const DEV_MODE = process.env.WEBPACK_MODE === 'development'\nexport const WAD_CACHE_DB_NAME = 'RockRaidersWeb'\nexport const JOB_SCHEDULE_INTERVAL = 1000 // milliseconds\nexport const CHECK_CLEAR_RUBBLE_INTERVAL = 5000 // milliseconds\nexport const CHECK_SPAWN_RAIDER_TIMER = 1000 // milliseconds\nexport const MAX_RAIDER_BASE = 12\nexport const MAX_RAIDER_REQUEST = 9\nexport const ADDITIONAL_RAIDER_PER_SUPPORT = 10\nexport const PANEL_ANIMATION_MULTIPLIER = 3\nexport const HEIGHT_MULTIPLIER = 0.1\nexport const SEQUENCE_TEXTURE_INTERVAL_MS = 1000 / 5\nexport const KEY_PAN_SPEED = 20\nexport const SPIDER_SLIP_RANGE_SQ = 49\nexport const ITEM_ACTION_RANGE_SQ = 49\nexport const UPDATE_INTERVAL_MS = Math.round(1000 / 30)\n\n// native constants (do not change)\n\nexport const SPRITE_RESOLUTION_WIDTH = 640\nexport const SPRITE_RESOLUTION_HEIGHT = 480\nexport const TILESIZE = 40\nexport const NATIVE_FRAMERATE = 30\nexport const NATIVE_UPDATE_INTERVAL = 1000 / NATIVE_FRAMERATE\n","import { setPixel } from '../core/ImageHelper'\n\n/**\n * References for FLIC file formats (FLC, FLI and FLH)\n *\n * https://www.compuphase.com/flic.htm#DELTA_FLC\n * https://github.com/miningmanna/LRR-remake/blob/master/src/org/rrr/assets/tex/FLHFile.java\n * https://www.drdobbs.com/windows/the-flic-file-format/184408954\n * http://bespin.org/~qz/pc-gpe/fli.for\n * https://github.com/aseprite/flic/blob/main/decoder.cpp\n *\n */\n\nexport class FlhParser {\n\n    dataView: DataView = null\n    fileLength: number = null\n    flicFileType: number = null\n    lengthFrames: number = null\n    frames: Array<ImageData> = null\n    width: number = null\n    height: number = null\n    depth: number = null\n    offsetFirstFrame: number = null\n\n    parse(flhContent: ArrayBufferLike): ImageData[] {\n        this.dataView = new DataView(flhContent)\n        this.parseHeader()\n        this.parseChunks()\n        return this.frames\n    }\n\n    private parseHeader() {\n        this.fileLength = this.getDWord(0)\n        this.flicFileType = this.getWord(4)\n        if (this.flicFileType !== 0xAF43) console.warn('Unexpected FLIC file type found: ' + this.flicFileType + ' does not match expected 0xAF43')\n        this.lengthFrames = this.getWord(6)\n        this.frames = new Array(this.lengthFrames)\n        this.width = this.getWord(8)\n        this.height = this.getWord(10)\n        this.depth = this.getWord(12)\n        if (this.depth != 16) console.warn('Expected 16 bit colors in flh file; got instead: ' + this.depth)\n        // const flags = this.getWord(14) // always 0\n        // const speed = this.getDWord(16) // delay between frames; always 0\n        this.offsetFirstFrame = this.getDWord(80)\n    }\n\n    private parseChunks() {\n        let frameIndex = 0\n        for (let chunkStart = this.offsetFirstFrame; chunkStart < this.fileLength;) {\n            const chunkLength = this.getDWord(chunkStart)\n            const chunkType = this.getWord(chunkStart + 4)\n            const chunkDataView = new DataView(this.dataView.buffer.slice(chunkStart + 6, chunkStart + chunkLength)) // TODO do not slice buffer, but instead use offsets\n            switch (chunkType) {\n                case 0xF1FA:\n                    if (chunkLength > 16) {\n                        this.parseFrameType(chunkDataView, frameIndex)\n                        frameIndex++\n                    }\n                    break\n                default:\n                    console.warn('Unexpected chunk type: 0x' + chunkType.toString(16).toUpperCase())\n                    break\n            }\n            chunkStart += chunkLength\n        }\n    }\n\n    parseFrameType(seg: DataView, frameIndex: number) {\n        let offset = 0\n        const numChunks = seg.getUint16(offset, true)\n        if (numChunks > 1) {\n            console.warn('More than one sub-chunk; got instead: ' + numChunks)\n        }\n        offset += 2\n        offset += 2\n        offset += 2 // reserved = 0\n        offset += 4 // width and height override should be 0\n\n        let len = seg.getUint32(offset, true)\n        len -= 6\n        offset += 4\n        const chunkType = seg.getUint16(offset, true)\n        offset += 2\n\n        switch (chunkType) {\n            case 25:\n                this.parseDtaBrun(seg, offset, len, frameIndex)\n                break\n            case 27:\n                this.parseDeltaFlc(seg, offset, len, frameIndex)\n                break\n            default:\n                console.warn('Unsupported sub-chunk type: ' + chunkType)\n                break\n        }\n    }\n\n    private parseDtaBrun(seg: DataView, offset: number, len: number, frameIndex: number) {\n        const imgData = new ImageData(this.width, this.height)\n        let x = 0\n        let y = 0\n        let w = this.width\n        offset += 1\n        while ((len - offset) > 0) {\n            let repeat = seg.getInt8(offset)\n            if (repeat < 0) {\n                repeat = (repeat * -1)\n                for (let i = 0; i < repeat; i++) {\n                    const [r, g, b] = this.getARGBFrom555RGB(seg, offset + i * 2 + 1)\n                    setPixel(imgData, x, y, r, g, b, (!r && !g && !b ? 0 : 255)) // TODO these loops can be simplified, don't use x y\n                    x++\n                }\n                offset += repeat * 2 + 1\n            } else {\n                const [r, g, b] = this.getARGBFrom555RGB(seg, offset + 1)\n                for (let i = 0; i < repeat; i++) {\n                    setPixel(imgData, x, y, r, g, b, (!r && !g && !b ? 0 : 255)) // TODO these loops can be simplified, don't use x y\n                    x++\n                }\n                offset += 3\n            }\n            if (x >= w) {\n                x %= w\n                y++\n                if (y > this.height) break\n                offset++\n            }\n        }\n        this.frames[frameIndex] = imgData\n    }\n\n    private parseDeltaFlc(seg: DataView, offset: number, len: number, frameIndex: number) {\n        const res = new ImageData(this.width, this.height)\n        if (frameIndex > 0) {\n            res.data.set(this.frames[frameIndex - 1].data)\n        }\n        const numLines = seg.getUint16(offset, true)\n        offset += 2\n        let y = 0\n        let linesDone = 0\n        while ((len - offset) > 0) {\n            if (numLines === linesDone) {\n                console.warn('All lines already done. Unexpected data at: ' + (len - offset))\n                break\n            }\n            let packCount = -1\n            while (packCount === -1) {\n                const opcode = seg.getInt16(offset, true)\n                offset += 2\n                const opType = (0x0000C000 & opcode) >> 14\n                switch (opType) {\n                    case 0:\n                        packCount = opcode\n                        break\n                    case 1: // undefined opcode according to specs\n                        console.warn('Undefined opcode: ' + opcode)\n                        break\n                    case 2:\n                        // console.log('Last Pixel?')\n                        break\n                    case 3:\n                        y += Math.abs(opcode) & 0x000000FF\n                        break\n                    default:\n                        console.warn('Unknown opType: ' + opType + '; opcode: ' + opcode)\n                        break\n                }\n            }\n            let x = 0\n            for (let i = 0; i < packCount; i++) {\n                x += 0x000000FF & seg.getInt8(offset)\n                offset++\n                let repeat = seg.getInt8(offset)\n                offset++\n                if (repeat < 0) {\n                    repeat = (-1 * repeat)\n                    const [r, g, b] = this.getARGBFrom555RGB(seg, offset) // TODO these loops can be simplified, don't use x y\n                    for (let j = 0; j < repeat; j++) {\n                        setPixel(res, x, y, r, g, b)\n                        x++\n                    }\n                    offset += 2\n                } else {\n                    for (let j = 0; j < repeat; j++) {\n                        const [r, g, b] = this.getARGBFrom555RGB(seg, offset + j * 2) // TODO these loops can be simplified, don't use x y\n                        setPixel(res, x, y, r, g, b)\n                        x++\n                    }\n                    offset += repeat * 2\n                }\n            }\n            y++\n            linesDone++\n        }\n        this.frames[frameIndex] = res\n    }\n\n    private getARGBFrom555RGB(a: DataView, offset: number): [number, number, number] {\n        let rgb = 0x000000FF\n        rgb &= a.getInt8(offset + 1)\n        rgb = rgb << 8\n        rgb |= 0x000000FF & a.getInt8(offset)\n        let r = Math.floor((rgb >> 10) * (255.0 / 31.0))\n        let g = Math.floor(((rgb >> 5) & 0b00011111) * (255.0 / 31.0))\n        let b = Math.floor((rgb & 0b00011111) * (255.0 / 31.0))\n        return [r, g, b]\n    }\n\n    private getDWord(offset: number): number {\n        return this.dataView.getUint32(offset, true)\n    }\n\n    private getWord(offset: number): number {\n        return this.dataView.getUint16(offset, true)\n    }\n\n}\n","/**\n * Source: https://github.com/wokwi/bmp-ts\n */\n\nenum HeaderTypes {\n    BITMAP_INFO_HEADER = 40,\n    BITMAP_V2_INFO_HEADER = 52,\n    BITMAP_V3_INFO_HEADER = 56,\n    BITMAP_V4_HEADER = 108,\n    BITMAP_V5_HEADER = 124\n}\n\n// We have these:\n//\n// const sample = 0101 0101 0101 0101\n// const mask   = 0111 1100 0000 0000\n// 256        === 0000 0001 0000 0000\n//\n// We want to take the sample and turn it into an 8-bit value.\n//\n// 1. We extract the last bit of the mask:\n//\n// 0000 0100 0000 0000\n//       ^\n//\n// Like so:\n//\n// const a = ~mask =    1000 0011 1111 1111\n// const b = a + 1 =    1000 0100 0000 0000\n// const c = b & mask = 0000 0100 0000 0000\n//\n// 2. We shift it to the right and extract the bit before the first:\n//\n// 0000 0000 0010 0000\n//             ^\n//\n// Like so:\n//\n// const d = mask / c = 0000 0000 0001 1111\n// const e = mask + 1 = 0000 0000 0010 0000\n//\n// 3. We apply the mask and the two values above to a sample:\n//\n// const f = sample & mask = 0101 0100 0000 0000\n// const g = f / c =         0000 0000 0001 0101\n// const h = 256 / e =       0000 0000 0000 0100\n// const i = g * h =         0000 0000 1010 1000\n//                                     ^^^^ ^\n//\n// Voila, we have extracted a sample and \"stretched\" it to 8 bits. For samples\n// which are already 8-bit, h === 1 and g === i.\n\nfunction maskColor(\n    maskRed: number,\n    maskGreen: number,\n    maskBlue: number,\n    maskAlpha: number,\n) {\n    const maskRedR = (~maskRed + 1) & maskRed\n    const maskGreenR = (~maskGreen + 1) & maskGreen\n    const maskBlueR = (~maskBlue + 1) & maskBlue\n    const maskAlphaR = (~maskAlpha + 1) & maskAlpha\n\n    const shiftedMaskRedL = maskRed / maskRedR + 1\n    const shiftedMaskGreenL = maskGreen / maskGreenR + 1\n    const shiftedMaskBlueL = maskBlue / maskBlueR + 1\n    const shiftedMaskAlphaL = maskAlpha / maskAlphaR + 1\n\n    return {\n        shiftRed: (x: number) =>\n            (((x & maskRed) / maskRedR) * 0x100) / shiftedMaskRedL,\n        shiftGreen: (x: number) =>\n            (((x & maskGreen) / maskGreenR) * 0x100) / shiftedMaskGreenL,\n        shiftBlue: (x: number) =>\n            (((x & maskBlue) / maskBlueR) * 0x100) / shiftedMaskBlueL,\n        shiftAlpha:\n            maskAlpha !== 0\n                ? (x: number) =>\n                (((x & maskAlpha) / maskAlphaR) * 0x100) / shiftedMaskAlphaL\n                : () => 255,\n    }\n}\n\nconst enum Compression {\n    NONE = 0,\n    BI_RLE8 = 1,\n    BI_RLE4 = 2,\n    BI_BIT_FIELDS = 3,\n    BI_ALPHA_BIT_FIELDS = 6\n}\n\ntype BitsPerPixel = 1 | 4 | 8 | 16 | 24 | 32;\n\ninterface IColor {\n    red: number;\n    green: number;\n    blue: number;\n    quad: number;\n}\n\ninterface IDecoderOptions {\n    toRGBA?: boolean;\n}\n\ninterface IImage {\n    width: number;\n    height: number;\n    bitPP: BitsPerPixel;\n    data: Uint8Array;\n    reserved1?: number;\n    reserved2?: number;\n    hr?: number;\n    vr?: number;\n    colors?: number;\n    importantColors?: number;\n    palette?: IColor[];\n}\n\ninterface IBitmapImage extends IImage {\n    flag: string;\n    fileSize: number;\n    offset: number;\n    headerSize: number;\n    planes?: number;\n    compression?: Compression;\n    rawSize: number;\n}\n\ntype IColorProcessor = (x: number, line: number) => void;\n\nclass BmpDecoder implements IBitmapImage {\n    // Header\n    public flag: string\n    public fileSize!: number\n    public reserved1!: number\n    public reserved2!: number\n    public offset!: number\n    public headerSize!: number\n    public width!: number\n    public height!: number\n    public planes!: number\n    public bitPP!: BitsPerPixel\n    public compression?: Compression\n    public rawSize!: number\n    public hr!: number\n    public vr!: number\n    public colors!: number\n    public importantColors!: number\n    public palette!: IColor[]\n    public data!: Uint8Array\n\n    private maskRed!: number\n    private maskGreen!: number\n    private maskBlue!: number\n    private maskAlpha!: number\n\n    private readonly toRGBA: boolean\n\n    private pos: number\n    private bottomUp: boolean\n    private readonly buffer: Uint8Array\n    private readonly bufferView: DataView\n\n    private readonly locRed: number\n    private readonly locGreen: number\n    private readonly locBlue: number\n    private readonly locAlpha: number\n\n    private shiftRed!: (x: number) => number\n    private shiftGreen!: (x: number) => number\n    private shiftBlue!: (x: number) => number\n    private shiftAlpha!: (x: number) => number\n\n    constructor(\n        buffer: Uint8Array,\n        {toRGBA}: IDecoderOptions = {toRGBA: false},\n    ) {\n        this.buffer = buffer\n        this.bufferView = new DataView(\n            buffer.buffer,\n            buffer.byteOffset,\n            buffer.byteLength,\n        )\n        this.toRGBA = !!toRGBA\n        this.bottomUp = true\n        this.flag = String.fromCharCode(this.buffer[0]) + String.fromCharCode(this.buffer[1])\n        this.pos = 2\n\n        if (this.flag !== 'BM') {\n            throw new Error('Invalid BMP File')\n        }\n\n        this.locRed = this.toRGBA ? 0 : 3\n        this.locGreen = this.toRGBA ? 1 : 2\n        this.locBlue = this.toRGBA ? 2 : 1\n        this.locAlpha = this.toRGBA ? 3 : 0\n\n        this.parseHeader()\n        this.parseRGBA()\n    }\n\n    private parseHeader() {\n        this.fileSize = this.readUInt32LE()\n\n        this.reserved1 = this.bufferView.getUint16(this.pos, true)\n        this.pos += 2\n        this.reserved2 = this.bufferView.getUint16(this.pos, true)\n        this.pos += 2\n\n        this.offset = this.readUInt32LE()\n\n        // End of BITMAP_FILE_HEADER\n        this.headerSize = this.readUInt32LE()\n\n        if (!(this.headerSize in HeaderTypes)) {\n            throw new Error(`Unsupported BMP header size ${this.headerSize}`)\n        }\n\n        this.width = this.readUInt32LE()\n        this.height = this.readUInt32LE()\n\n        this.planes = this.bufferView.getUint16(this.pos, true)\n        this.pos += 2\n        this.bitPP = this.bufferView.getUint16(this.pos, true) as BitsPerPixel\n        this.pos += 2\n\n        this.compression = this.readUInt32LE()\n        this.rawSize = this.readUInt32LE()\n        this.hr = this.readUInt32LE()\n        this.vr = this.readUInt32LE()\n        this.colors = this.readUInt32LE()\n        this.importantColors = this.readUInt32LE()\n\n        // De facto defaults\n\n        if (this.bitPP === 32) {\n            this.maskAlpha = 0\n            this.maskRed = 0x00ff0000\n            this.maskGreen = 0x0000ff00\n            this.maskBlue = 0x000000ff\n        } else if (this.bitPP === 16) {\n            this.maskAlpha = 0\n            this.maskRed = 0x7c00\n            this.maskGreen = 0x03e0\n            this.maskBlue = 0x001f\n        }\n\n        // End of BITMAP_INFO_HEADER\n\n        if (\n            this.headerSize > HeaderTypes.BITMAP_INFO_HEADER ||\n            this.compression === Compression.BI_BIT_FIELDS ||\n            this.compression === Compression.BI_ALPHA_BIT_FIELDS\n        ) {\n            this.maskRed = this.readUInt32LE()\n            this.maskGreen = this.readUInt32LE()\n            this.maskBlue = this.readUInt32LE()\n        }\n\n        // End of BITMAP_V2_INFO_HEADER\n\n        if (\n            this.headerSize > HeaderTypes.BITMAP_V2_INFO_HEADER ||\n            this.compression === Compression.BI_ALPHA_BIT_FIELDS\n        ) {\n            this.maskAlpha = this.readUInt32LE()\n        }\n\n        // End of BITMAP_V3_INFO_HEADER\n\n        if (this.headerSize > HeaderTypes.BITMAP_V3_INFO_HEADER) {\n            this.pos +=\n                HeaderTypes.BITMAP_V4_HEADER - HeaderTypes.BITMAP_V3_INFO_HEADER\n        }\n\n        // End of BITMAP_V4_HEADER\n\n        if (this.headerSize > HeaderTypes.BITMAP_V4_HEADER) {\n            this.pos += HeaderTypes.BITMAP_V5_HEADER - HeaderTypes.BITMAP_V4_HEADER\n        }\n\n        // End of BITMAP_V5_HEADER\n\n        if (this.bitPP <= 8 || this.colors > 0) {\n            const len = this.colors === 0 ? 1 << this.bitPP : this.colors\n            this.palette = new Array(len)\n\n            for (let i = 0; i < len; i++) {\n                const blue = this.buffer[this.pos++]\n                const green = this.buffer[this.pos++]\n                const red = this.buffer[this.pos++]\n                const quad = this.buffer[this.pos++]\n\n                this.palette[i] = {\n                    red,\n                    green,\n                    blue,\n                    quad,\n                }\n            }\n        }\n\n        // End of color table\n\n        // Can the height ever be negative?\n        if (this.height < 0) {\n            this.height *= -1\n            this.bottomUp = false\n        }\n\n        const coloShift = maskColor(\n            this.maskRed,\n            this.maskGreen,\n            this.maskBlue,\n            this.maskAlpha,\n        )\n\n        this.shiftRed = coloShift.shiftRed\n        this.shiftGreen = coloShift.shiftGreen\n        this.shiftBlue = coloShift.shiftBlue\n        this.shiftAlpha = coloShift.shiftAlpha\n    }\n\n    private parseRGBA() {\n        this.data = new Uint8Array(this.width * this.height * 4)\n\n        switch (this.bitPP) {\n            case 1:\n                this.bit1()\n                break\n            case 4:\n                this.bit4()\n                break\n            case 8:\n                this.bit8()\n                break\n            case 16:\n                this.bit16()\n                break\n            case 24:\n                this.bit24()\n                break\n            default:\n                this.bit32()\n        }\n    }\n\n    private bit1() {\n        const xLen = Math.ceil(this.width / 8)\n        const mode = xLen % 4\n        const padding = mode !== 0 ? 4 - mode : 0\n\n        let lastLine: number | undefined\n\n        this.scanImage(padding, xLen, (x, line) => {\n            if (line !== lastLine) {\n                lastLine = line\n            }\n\n            const b = this.buffer[this.pos++]\n            const location = line * this.width * 4 + x * 8 * 4\n\n            for (let i = 0; i < 8; i++) {\n                if (x * 8 + i < this.width) {\n                    const rgb = this.palette[(b >> (7 - i)) & 0x1]\n\n                    this.data[location + i * 4 + this.locAlpha] = 0xff\n                    this.data[location + i * 4 + this.locBlue] = rgb.blue\n                    this.data[location + i * 4 + this.locGreen] = rgb.green\n                    this.data[location + i * 4 + this.locRed] = rgb.red\n                } else {\n                    break\n                }\n            }\n        })\n    }\n\n    private bit4() {\n        if (this.compression === Compression.BI_RLE4) {\n            this.data.fill(0)\n\n            let lowNibble = false //for all count of pixel\n            let lines = this.bottomUp ? this.height - 1 : 0\n            let location = 0\n\n            while (location < this.data.length) {\n                const a = this.buffer[this.pos++]\n                const b = this.buffer[this.pos++]\n\n                //absolute mode\n                if (a === 0) {\n                    if (b === 0) {\n                        //line end\n                        lines += this.bottomUp ? -1 : 1\n                        location = lines * this.width * 4\n                        lowNibble = false\n\n                        continue\n                    }\n\n                    if (b === 1) {\n                        // image end\n                        break\n                    }\n\n                    if (b === 2) {\n                        // offset x, y\n                        const x = this.buffer[this.pos++]\n                        const y = this.buffer[this.pos++]\n\n                        lines += this.bottomUp ? -y : y\n                        location += y * this.width * 4 + x * 4\n                    } else {\n                        let c = this.buffer[this.pos++]\n\n                        for (let i = 0; i < b; i++) {\n                            location = this.setPixelData(\n                                location,\n                                lowNibble ? c & 0x0f : (c & 0xf0) >> 4,\n                            )\n\n                            if (i & 1 && i + 1 < b) {\n                                c = this.buffer[this.pos++]\n                            }\n\n                            lowNibble = !lowNibble\n                        }\n\n                        if ((((b + 1) >> 1) & 1) === 1) {\n                            this.pos++\n                        }\n                    }\n                } else {\n                    //encoded mode\n                    for (let i = 0; i < a; i++) {\n                        location = this.setPixelData(\n                            location,\n                            lowNibble ? b & 0x0f : (b & 0xf0) >> 4,\n                        )\n                        lowNibble = !lowNibble\n                    }\n                }\n            }\n        } else {\n            const xLen = Math.ceil(this.width / 2)\n            const mode = xLen % 4\n            const padding = mode !== 0 ? 4 - mode : 0\n\n            this.scanImage(padding, xLen, (x, line) => {\n                const b = this.buffer[this.pos++]\n                const location = line * this.width * 4 + x * 2 * 4\n\n                const first4 = b >> 4\n                let rgb = this.palette[first4]\n\n                this.data[location + this.locAlpha] = 0xff\n                this.data[location + this.locBlue] = rgb.blue\n                this.data[location + this.locGreen] = rgb.green\n                this.data[location + this.locRed] = rgb.red\n\n                if (x * 2 + 1 >= this.width) {\n                    // throw new Error('Something');\n                    return false\n                }\n\n                const last4 = b & 0x0f\n                rgb = this.palette[last4]\n\n                this.data[location + 4 + this.locAlpha] = 0xff\n                this.data[location + 4 + this.locBlue] = rgb.blue\n                this.data[location + 4 + this.locGreen] = rgb.green\n                this.data[location + 4 + this.locRed] = rgb.red\n            })\n        }\n    }\n\n    private bit8() {\n        if (this.compression === Compression.BI_RLE8) {\n            this.data.fill(0)\n\n            let lines = this.bottomUp ? this.height - 1 : 0\n            let location = 0\n\n            while (location < this.data.length) {\n                const a = this.buffer[this.pos++]\n                const b = this.buffer[this.pos++]\n\n                //absolute mode\n                if (a === 0) {\n                    if (b === 0) {\n                        //line end\n                        lines += this.bottomUp ? -1 : 1\n                        location = lines * this.width * 4\n                        continue\n                    }\n\n                    if (b === 1) {\n                        //image end\n                        break\n                    }\n\n                    if (b === 2) {\n                        //offset x,y\n                        const x = this.buffer[this.pos++]\n                        const y = this.buffer[this.pos++]\n\n                        lines += this.bottomUp ? -y : y\n                        location += y * this.width * 4 + x * 4\n                    } else {\n                        for (let i = 0; i < b; i++) {\n                            const c = this.buffer[this.pos++]\n                            location = this.setPixelData(location, c)\n                        }\n\n                        // @ts-ignore\n                        const shouldIncrement = b & (1 === 1)\n                        if (shouldIncrement) {\n                            this.pos++\n                        }\n                    }\n                } else {\n                    //encoded mode\n                    for (let i = 0; i < a; i++) {\n                        location = this.setPixelData(location, b)\n                    }\n                }\n            }\n        } else {\n            const mode = this.width % 4\n            const padding = mode !== 0 ? 4 - mode : 0\n\n            this.scanImage(padding, this.width, (x, line) => {\n                const b = this.buffer[this.pos++]\n                const location = line * this.width * 4 + x * 4\n\n                if (b < this.palette.length) {\n                    const rgb = this.palette[b]\n\n                    this.data[location + this.locAlpha] = 0xff\n                    this.data[location + this.locBlue] = rgb.blue\n                    this.data[location + this.locGreen] = rgb.green\n                    this.data[location + this.locRed] = rgb.red\n                }\n            })\n        }\n    }\n\n    private bit16() {\n        const padding = (this.width % 2) * 2\n\n        this.scanImage(padding, this.width, (x, line) => {\n            const loc = line * this.width * 4 + x * 4\n            const px = this.bufferView.getUint16(this.pos, true)\n            this.pos += 2\n\n            this.data[loc + this.locRed] = this.shiftRed(px)\n            this.data[loc + this.locGreen] = this.shiftGreen(px)\n            this.data[loc + this.locBlue] = this.shiftBlue(px)\n            this.data[loc + this.locAlpha] = this.shiftAlpha(px)\n        })\n    }\n\n    private bit24() {\n        const padding = this.width % 4\n\n        this.scanImage(padding, this.width, (x, line) => {\n            const loc = line * this.width * 4 + x * 4\n            const blue = this.buffer[this.pos++]\n            const green = this.buffer[this.pos++]\n            const red = this.buffer[this.pos++]\n\n            this.data[loc + this.locAlpha] = 0xff\n            this.data[loc + this.locBlue] = blue\n            this.data[loc + this.locGreen] = green\n            this.data[loc + this.locRed] = red\n        })\n    }\n\n    private bit32() {\n        this.scanImage(0, this.width, (x, line) => {\n            const loc = line * this.width * 4 + x * 4\n            const px = this.readUInt32LE()\n\n            this.data[loc + this.locAlpha] = this.shiftAlpha(px)\n            this.data[loc + this.locBlue] = this.shiftBlue(px)\n            this.data[loc + this.locGreen] = this.shiftGreen(px)\n            this.data[loc + this.locRed] = this.shiftRed(px)\n        })\n    }\n\n    private scanImage(\n        padding = 0,\n        width = this.width,\n        processPixel: IColorProcessor,\n    ) {\n        for (let y = this.height - 1; y >= 0; y--) {\n            const line = this.bottomUp ? y : this.height - 1 - y\n\n            for (let x = 0; x < width; x++) {\n                processPixel.call(this, x, line)\n            }\n\n            this.pos += padding\n        }\n    }\n\n    private readUInt32LE() {\n        const value = this.bufferView.getUint32(this.pos, true)\n        this.pos += 4\n        return value\n    }\n\n    private setPixelData(location: number, rgbIndex: number) {\n        const {blue, green, red} = this.palette[rgbIndex]\n\n        this.data[location + this.locAlpha] = 0xff\n        this.data[location + this.locBlue] = blue\n        this.data[location + this.locGreen] = green\n        this.data[location + this.locRed] = red\n\n        return location + 4\n    }\n}\n\nexport class BitmapWithPalette extends ImageData {\n\n    readonly palette: IColor[]\n\n    static decode(buffer: Uint8Array): BitmapWithPalette {\n        return new BitmapWithPalette(new BmpDecoder(buffer, {toRGBA: true}))\n    }\n\n    constructor(decoder: BmpDecoder) {\n        super(new Uint8ClampedArray(decoder.data), decoder.width, decoder.height)\n        this.palette = decoder.palette\n    }\n\n    applyAlphaByIndex(alphaIndex: number): BitmapWithPalette {\n        if (alphaIndex || alphaIndex === 0) {\n            const alphaColor = this.palette?.[alphaIndex] // XXX fails for a102_bigtyre.bmp\n            if (alphaColor) {\n                const data = this.data\n                for (let c = 0; c < data.length; c += 4) {\n                    data[c + 3] = alphaColor.red === data[c] && alphaColor.green === data[c + 1] && alphaColor.blue === data[c + 2] ? 0 : 255\n                }\n            }\n        }\n        return this\n    }\n\n    applyAlpha(): BitmapWithPalette {\n        const data = this.data\n        for (let n = 0; n < data.length; n += 4) {\n            if (data[n] <= 2 && data[n + 1] <= 2 && data[n + 2] <= 2) { // Interface/Reward/RSoxygen.bmp uses 2/2/2 as \"black\" alpha background\n                data[n + 3] = 0\n            }\n        }\n        return this\n    }\n\n}\n","export const encodeChar: number[] = []\n\nfor (let c = 0; c < 256; c++) {\n    encodeChar[c] = c\n}\nencodeChar[130] = 0x00E4 // ä\nencodeChar[142] = 0x00C4 // Ä\nencodeChar[162] = 0x00F6 // ö\nencodeChar[167] = 0x00DC // Ü\nencodeChar[171] = 0x00FC // ü\nencodeChar[195] = 0x00DF // ß\n","import { encodeChar } from './EncodingHelper'\n\nconst enum PARSING_STATE {\n\n    LOOKING_FOR_KEY,\n    INSIDE_KEY,\n    LOOKING_FOR_VALUE,\n    INSIDE_VALUE,\n\n}\n\nexport class CfgFileParser {\n\n    static parse(buffer): any {\n        const result = {}\n        const ancestry = []\n        let activeObject = result\n        let isComment = false\n        let parsingState: PARSING_STATE = PARSING_STATE.LOOKING_FOR_KEY\n        let key = ''\n        let value = ''\n        // debug output is a bad idea here, buffer size is about 232.611 characters and has 6781 lines\n        for (let seek = 0; seek < buffer.length; seek++) {\n            let charCode = buffer[seek]\n            if (charCode === 123 && key === 'FullName') { // dirty workaround but in the original file { (123) was used instead of Ä (142)\n                charCode = 142\n            }\n            let charStr = String.fromCharCode(encodeChar[charCode])\n            if (charStr === ';' || charStr === '/') { // someone used // as a marker for a comment\n                isComment = true\n            } else if (charCode === 10 || charCode === 13) {\n                isComment = false\n            }\n            if (!isComment) {\n                if (charCode > 32) { // not a whitespace\n                    if (parsingState === PARSING_STATE.LOOKING_FOR_KEY) {\n                        if (charStr === '}') {\n                            activeObject = ancestry.pop()\n                        } else {\n                            key = charStr\n                            parsingState = PARSING_STATE.INSIDE_KEY\n                        }\n                    } else if (parsingState === PARSING_STATE.INSIDE_KEY) {\n                        key += charStr\n                    } else if (parsingState === PARSING_STATE.LOOKING_FOR_VALUE) {\n                        if (charStr === '{') { // start of a new object key is identifier\n                            ancestry.push(activeObject)\n                            activeObject = {}\n                            ancestry[ancestry.length - 1][key] = activeObject\n                            parsingState = PARSING_STATE.LOOKING_FOR_KEY\n                        } else {\n                            value = charStr\n                            parsingState = PARSING_STATE.INSIDE_VALUE\n                        }\n                    } else if (parsingState === PARSING_STATE.INSIDE_VALUE) {\n                        value += charStr\n                    }\n                } else { // some whitespace\n                    if (parsingState === PARSING_STATE.INSIDE_KEY) {\n                        parsingState = PARSING_STATE.LOOKING_FOR_VALUE\n                    } else if (parsingState === PARSING_STATE.INSIDE_VALUE) {\n                        const parsed = CfgFileParser.parseValue(value)\n                        if (activeObject.hasOwnProperty(key)) {\n                            activeObject[key].push(parsed)\n                        } else {\n                            activeObject[key] = [parsed]\n                        }\n                        parsingState = PARSING_STATE.LOOKING_FOR_KEY\n                    }\n                }\n            }\n        }\n\n        const stack = [result]\n        while (stack.length > 0) {\n            const obj = stack.pop()\n            Object.keys(obj).forEach((key) => {\n                const val = obj[key]\n                if (Array.isArray(val)) {\n                    if (val.length === 1) {\n                        obj[key] = val[0]\n                    } else {\n                        val.forEach((sub) => stack.push(sub))\n                    }\n                } else if (Object.keys(val).length > 1) {\n                    stack.push(val)\n                }\n            })\n        }\n\n        // apply some patches here\n        Object.values(result['Lego*']['Levels']).forEach((levelConf) => {\n            if (levelConf['CryoreMap']) {\n                levelConf['CryOreMap'] = levelConf['CryoreMap']  // typos... typos everywhere\n                delete levelConf['CryoreMap']\n            }\n            if (levelConf['CryOreMap']) {\n                levelConf['CryOreMap'] = levelConf['CryOreMap'].replace('Cryo_', 'Cror_')\n            }\n            if (levelConf['PredugMap']) {\n                levelConf['PreDugMap'] = levelConf['PredugMap']\n                delete levelConf['PredugMap']\n            }\n            const textureSet = levelConf['TextureSet']\n            if (Array.isArray(textureSet) && Array.isArray(textureSet[1])) {\n                levelConf['TextureSet'] = textureSet[1]\n            }\n        })\n        const dependencies = result['Lego*']['Dependencies']\n        Object.keys(dependencies).forEach((key) => {\n            const flatDeps = []\n            dependencies[key].forEach((d) => {\n                if (Array.isArray(d)) {\n                    flatDeps.push(...d)\n                } else {\n                    flatDeps.push(d)\n                }\n            })\n            dependencies[key] = flatDeps.reduce((result, value, index, array) => {\n                if (index % 2 === 0)\n                    result.push(array.slice(index, index + 2))\n                return result\n            }, [])\n        })\n\n        return result['Lego*']\n    }\n\n    static parseValue(val) {\n        function splitShrink(sep) {\n            val = val.split(sep).filter(val => val !== '').map(val => CfgFileParser.parseValue(val))\n            if (val.length === 0) {\n                val = ''\n            } else if (val.length === 1) {\n                val = val[0]\n            }\n        }\n\n        const num = Number(val)\n        if (isNaN(num)) {\n            val = val.toString().replace(/\\\\/g, '/')\n            const lVal = val.toLowerCase()\n            if (lVal === 'true') return true\n            if (lVal === 'false') return false\n            if (lVal === 'null') return ''\n            if (val.includes(':')) { // XXX Dependencies uses separator , over : however icon panel entries use : over ,\n                splitShrink.call(this, ':')\n            } else if (val.includes(',')) {\n                splitShrink.call(this, ',')\n            } else if (val.includes('|')) {\n                splitShrink.call(this, '|')\n            }\n            return val\n        } else {\n            return num\n        }\n    }\n\n}\n","export class LevelObjectiveTextEntry {\n\n    key: string\n    objective: string\n    failure: string\n    completion: string\n    crystalFailure: string\n\n}\n","import { LevelObjectiveTextEntry } from '../../../cfg/LevelObjectiveTextEntry'\nimport { encodeChar } from './EncodingHelper'\n\nexport class ObjectiveTextParser {\n\n    parseObjectiveTextFile(txtFileContent: Uint8Array) {\n        const result = {}\n        let state = PARSING_STATE.DROP\n        let currentLevel: LevelObjectiveTextEntry = null\n        let value = ''\n        let line = ''\n        for (let c = 0; c < txtFileContent.length; c++) {\n            const code = encodeChar[txtFileContent[c]]\n            let char = String.fromCharCode(code)\n            if (state === PARSING_STATE.DROP) {\n                if (char === '[') {\n                    if (currentLevel) result[currentLevel.key] = currentLevel\n                    currentLevel = new LevelObjectiveTextEntry()\n                    state = PARSING_STATE.KEY\n                } else if (currentLevel && char === ':') {\n                    const lLine = line.toLowerCase()\n                    if (lLine === 'objective') {\n                        line = ''\n                        state = PARSING_STATE.OBJECTIVE\n                    } else if (lLine === 'failure') {\n                        line = ''\n                        state = PARSING_STATE.FAILURE\n                    } else if (lLine === 'completion') {\n                        line = ''\n                        state = PARSING_STATE.COMPLETION\n                    } else if (lLine === 'crystalfailure') {\n                        line = ''\n                        state = PARSING_STATE.CRYSTAL_FAILURE\n                    }\n                    for (; c < txtFileContent.length && txtFileContent[c + 1] === '\\t'.charCodeAt(0); c++) {\n                    }\n                } else if (char === '\\n' || char === '\\r') {\n                    line = ''\n                } else {\n                    line += char\n                }\n            } else if (state === PARSING_STATE.KEY) {\n                if (char === ']') {\n                    currentLevel.key = value\n                    value = ''\n                    state = PARSING_STATE.DROP\n                } else if (char === '\\n' || char === '\\r') {\n                    throw 'Malformed objective text file'\n                } else {\n                    value += char\n                }\n            } else if (state === PARSING_STATE.OBJECTIVE) {\n                if (char === '\\n' || char === '\\r') {\n                    currentLevel.objective = value\n                    value = ''\n                    state = PARSING_STATE.DROP\n                } else {\n                    value += char\n                }\n            } else if (state === PARSING_STATE.FAILURE) {\n                if (char === '\\n' || char === '\\r') {\n                    currentLevel.failure = value\n                    value = ''\n                    state = PARSING_STATE.DROP\n                } else {\n                    value += char\n                }\n            } else if (state === PARSING_STATE.COMPLETION) {\n                if (char === '\\n' || char === '\\r') {\n                    currentLevel.completion = value\n                    value = ''\n                    state = PARSING_STATE.DROP\n                } else {\n                    value += char\n                }\n            } else if (state === PARSING_STATE.CRYSTAL_FAILURE) {\n                if (char === '\\n' || char === '\\r') {\n                    currentLevel.crystalFailure = value\n                    value = ''\n                    state = PARSING_STATE.DROP\n                } else {\n                    value += char\n                }\n            }\n        }\n        if (currentLevel) result[currentLevel.key] = currentLevel\n        currentLevel = null\n        return result\n    }\n\n}\n\nenum PARSING_STATE {\n\n    DROP,\n    KEY,\n    OBJECTIVE,\n    FAILURE,\n    COMPLETION,\n    CRYSTAL_FAILURE,\n\n}\n\n","export enum PriorityIdentifier {\n\n    aiPriorityTrain,\n    aiPriorityGetIn,\n    aiPriorityCrystal,\n    aiPriorityOre,\n    aiPriorityRepair,\n    aiPriorityClearing,\n    aiPriorityDestruction,\n    aiPriorityConstruction,\n    aiPriorityReinforce,\n    aiPriorityRecharge,\n\n}\n","export enum WorkerMessageType {\n\n    // wad worker\n    MSG,\n    CFG,\n    CACHE_MISS,\n    SFX,\n    ASSET,\n    DONE,\n\n    // gui/scene worker\n    INIT,\n    CANVAS,\n    REDRAW,\n    RESET,\n    EVENT_POINTER,\n    EVENT_KEY,\n    EVENT_WHEEL,\n    RESPONSE_EVENT,\n    OVERLAY_SETUP,\n    SPACE_TO_CONINUE,\n    SHOW_OPTIONS,\n    GAME_ABORT,\n    GAME_RESTART,\n    GAME_EVENT,\n\n}\n","export class WadParser {\n\n    static parseMap(buffer: Uint8Array) {\n        const map = {width: buffer[8], height: buffer[12], level: []}\n        let row = []\n        for (let seek = 16; seek < buffer.length; seek += 2) {\n            row.push(buffer[seek])\n            if (row.length >= map.width) {\n                map.level.push(row)\n                row = []\n            }\n        }\n        return map\n    }\n\n    static parseObjectList(data: string) {\n        const lines = data.split('\\n')\n        const objectList = []\n        let currentObject = null\n        for (let c = 0; c < lines.length; c++) {\n            const line = lines[c].trim()\n            const objectStartMatch = line.match(/(.+)\\s+{/)\n            const drivingMatch = line.match(/driving\\s+(.+)/)\n            if (line.length < 1 || line.startsWith(';') || line.startsWith('Lego*')) {\n                // ignore empty lines, comments and the root object\n            } else if (objectStartMatch) {\n                currentObject = {}\n                objectList[objectStartMatch[1]] = currentObject\n            } else if (line === '}') {\n                currentObject = null\n            } else if (drivingMatch) {\n                currentObject.driving = drivingMatch[1]\n            } else {\n                const split = line.split(/\\s+/)\n                if (split.length !== 2 || currentObject === null) {\n                    throw 'Unexpected key value entry: ' + line\n                }\n                const key = split[0]\n                let val: any = split[1]\n                if (key === 'xPos' || key === 'yPos' || key === 'heading') {\n                    val = parseFloat(val)\n                } else if (key !== 'type') {\n                    throw 'Unexpected key value entry: ' + line\n                }\n                currentObject[key] = val\n            }\n        }\n        return objectList\n    }\n\n}\n","export class BaseConfig {\n\n    static setFromCfg(config: BaseConfig, cfgObj: any) {\n        Object.keys(cfgObj).forEach((cfgKey) => {\n            const lCfgKeyName = (cfgKey.startsWith('!') ? cfgKey.substring(1) : cfgKey)\n                .toLowerCase()\n                .replace(/_/g, '') // Activity_Stand\n                .replace(/-/g, '') // Geo-dome\n            const found = Object.keys(config).some((objKey) => {\n                return config.assignValue(objKey, lCfgKeyName, cfgObj[cfgKey])\n            })\n            if (!found) {\n                console.warn('cfg key: ' + cfgKey + ' does not exist in cfg: ' + config?.constructor?.name)\n            }\n        })\n        return config\n    }\n\n    assignValue(objKey, lCfgKeyName, cfgValue): boolean {\n        if (objKey.toLowerCase() === lCfgKeyName) {\n            const currentValue = this[objKey]\n            const currentIsArray = Array.isArray(currentValue)\n            let parsedValue = this.parseValue(lCfgKeyName, cfgValue)\n            const parsedIsArray = Array.isArray(parsedValue)\n            if (currentValue && currentIsArray !== parsedIsArray) {\n                if (currentIsArray) {\n                    parsedValue = [parsedValue]\n                    // } else {\n                    //     console.warn('Array overwrite conflict for key ' + objKey + ' with existing value (' + currentValue + ') and new value (' + parsedValue + ')')\n                }\n            }\n            this[objKey] = parsedValue\n            return true\n        }\n    }\n\n    parseValue(lCfgKeyName: string, cfgValue: any): any {\n        return cfgValue\n    }\n\n}\n","export class ConfigColor {\n\n    r: number\n    g: number\n    b: number\n\n    constructor(values: number[]) {\n        [this.r, this.g, this.b] = values\n    }\n\n}\n","export class ObjectiveImageCfg {\n\n    filename: string\n    x: number\n    y: number\n\n    constructor(cfgValue: any) {\n        [this.filename, this.x, this.y] = cfgValue\n    }\n\n}\n","import { iGet } from '../core/Util'\nimport { PriorityIdentifier } from '../game/model/job/PriorityIdentifier'\nimport { BaseConfig } from './BaseConfig'\nimport { ConfigColor } from './ConfigColor'\nimport { ObjectiveImageCfg } from './ObjectiveImageCfg'\n\nexport class LevelsCfg {\n\n    levelsByName: {} = []\n\n    constructor(cfgObj: any) {\n        Object.keys(cfgObj).forEach((levelKey) => {\n            if (!levelKey.startsWith('Tutorial') && !levelKey.startsWith('Level')) return // ignore incomplete test levels and duplicates\n            this.levelsByName[levelKey] = new LevelEntryCfg(cfgObj[levelKey])\n        })\n    }\n\n}\n\nexport class LevelEntryCfg extends BaseConfig {\n\n    fullName: string = ''\n    endGameAvi1: string = ''\n    endGameAvi2: string = ''\n    allowRename: boolean = false\n    recallOLObjects: boolean = false\n    generateSpiders: boolean = false\n    video: string = ''\n    disableEndTeleport: boolean = false\n    disableStartTeleport: boolean = false\n    emergeTimeOut: any = ''\n    boulderAnimation: any = ''\n    noMultiSelect: any = ''\n    noAutoEat: any = ''\n    disableToolTipSound: any = ''\n    blockSize: any = ''\n    digDepth: any = ''\n    roughLevel: any = ''\n    roofHeight: any = ''\n    useRoof: any = ''\n    selBoxHeight: any = ''\n    fpRotLightRGB: any = ''\n    fogColourRGB: any = ''\n    highFogColourRGB: any = ''\n    fogRate: number = 0\n    fallinMultiplier: number = 0\n    numberOfLandSlidesTillCaveIn: number = 0\n    noFallins: boolean = false\n    oxygenRate: number = 0 // 0 - 100\n    surfaceMap: string = ''\n    predugMap: string = ''\n    terrainMap: string = ''\n    emergeMap: string = ''\n    erodeMap: string = ''\n    fallinMap: string = ''\n    blockPointersMap: string = ''\n    cryOreMap: string = ''\n    pathMap: string = ''\n    noGather: boolean = false\n    textureSet: string = ''\n    rockFallStyle: any = ''\n    emergeCreature: any = ''\n    safeCaverns: any = ''\n    seeThroughWalls: any = ''\n    oListFile: any = ''\n    ptlFile: any = ''\n    nerpFile: any = ''\n    nerpMessageFile: any = ''\n    objectiveText: any = ''\n    objectiveImage640x480: ObjectiveImageCfg = null\n    erodeTriggerTime: number = 0\n    erodeErodeTime: number = 0\n    erodeLockTime: number = 0\n    nextLevel: any = ''\n    levelLinks: any = ''\n    frontEndX: number = 0\n    frontEndY: number = 0\n    frontEndOpen: boolean = false\n    priorities: LevelPrioritiesEntryConfig[] = [] // priority order matters!\n    reward: LevelRewardConfig = null\n    menuBMP: string[] = []\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    parseValue(lCfgKeyName: string, cfgValue: any): any {\n        if (lCfgKeyName === 'fullName'.toLowerCase()) {\n            return cfgValue.replace(/_/g, ' ')\n        } else if (lCfgKeyName.endsWith('rgb')) {\n            return new ConfigColor(cfgValue)\n        } else if (lCfgKeyName === 'priorities') {\n            return Object.keys(cfgValue)\n                .filter(name => name.toLowerCase() !== 'AI_Priority_GetTool'.toLowerCase()) // not used in the game\n                .map(name => new LevelPrioritiesEntryConfig(name, cfgValue[name]))\n        } else if (lCfgKeyName === 'reward') {\n            return new LevelRewardConfig(cfgValue)\n        } else if (lCfgKeyName === 'objectiveimage640x480') {\n            return new ObjectiveImageCfg(cfgValue)\n        } else {\n            return super.parseValue(lCfgKeyName, cfgValue)\n        }\n    }\n\n}\n\nexport class LevelPrioritiesEntryConfig {\n\n    key: PriorityIdentifier\n    enabled: boolean\n\n    constructor(name: string, enabled: boolean) {\n        this.key = iGet(PriorityIdentifier, name.replace(/_/g, ''))\n        this.enabled = enabled\n    }\n\n}\n\nexport class LevelRewardConfig extends BaseConfig {\n\n    enable: boolean = true\n    modifier: number = null\n    importance: LevelRewardImportanceConfig = null\n    quota: LevelRewardQuotaConfig = null\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    parseValue(lCfgKeyName: string, cfgValue: any): any {\n        if (lCfgKeyName === 'importance') {\n            return new LevelRewardImportanceConfig(cfgValue)\n        } else if (lCfgKeyName === 'quota') {\n            return new LevelRewardQuotaConfig(cfgValue)\n        } else {\n            return super.parseValue(lCfgKeyName, cfgValue)\n        }\n    }\n}\n\nexport class LevelRewardImportanceConfig extends BaseConfig {\n\n    crystals: number = 0\n    timer: number = 0\n    caverns: number = 0\n    constructions: number = 0\n    oxygen: number = 0\n    figures: number = 0\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n}\n\nexport class LevelRewardQuotaConfig extends BaseConfig {\n\n    crystals: number = null\n    timer: number = null\n    caverns: number = null\n    constructions: number = null\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n}\n","export class MenuCycleItemCfg {\n\n    actionName: string\n    x: number\n    y: number\n    width: number\n    height: number\n    description: string\n    two: number // usage unclear\n    labelOff: string\n    labelOn: string\n\n    constructor(cfgObj: any) {\n        [this.actionName, this.x, this.y, this.width, this.height, this.description, this.two, this.labelOff, this.labelOn] = cfgObj\n        this.description = this.description.replace(/_/g, ' ')\n    }\n\n}\n","import { parseLabel } from './CfgHelper'\n\nexport class MenuLabelItemCfg {\n\n    actionName: string\n    x: number\n    y: number\n    label: string\n    imgNormal: string\n    imgHover: string\n    imgPressed: string\n    tooltip: string\n    target: string\n    flag: string // usage unclear\n\n    constructor(cfgObj: any) {\n        if (cfgObj.length === 5 || cfgObj.length === 6) {\n            [this.actionName, this.x, this.y, this.label, this.target, this.flag] = cfgObj\n            this.label = parseLabel(this.label)\n        } else if (cfgObj.length === 8) {\n            [this.actionName, this.x, this.y, this.imgNormal, this.imgHover, this.imgPressed, this.tooltip, this.target] = cfgObj\n        } else {\n            console.warn('Unexpected cfg object length: ' + cfgObj.length)\n            console.log(cfgObj)\n        }\n    }\n\n}\n","export function parseLabel(label: string[] | string): string {\n    const result = Array.isArray(label) ? label.join(',') : label // cfg parser does split(',')\n    return result?.replace(/_/g, ' ')\n}\n","export class MenuSliderItemCfg {\n\n    actionName: string\n    x: number\n    y: number\n    width: number\n    height: number\n    description: string\n    min: number\n    max: number\n    imgOff: string\n    imgOn: string\n    imgLeft: string\n    imgRight: string\n    btnLeftNormal: string\n    btnRightNormal: string\n    btnLeftHover: string\n    btnRightHover: string\n\n    constructor(cfgObj: any) {\n        [this.actionName, this.x, this.y, this.width, this.height, this.description, this.min, this.max, this.imgOff, this.imgOn,\n            this.imgLeft, this.imgRight, this.btnRightNormal, this.btnLeftNormal, this.btnRightHover, this.btnLeftHover] = cfgObj\n    }\n\n}\n","import { BaseConfig } from './BaseConfig'\nimport { MenuCycleItemCfg } from './MenuCycleItemCfg'\nimport { MenuLabelItemCfg } from './MenuLabelItemCfg'\nimport { MenuSliderItemCfg } from './MenuSliderItemCfg'\n\nexport class MenuEntryCfg extends BaseConfig {\n\n    fullName: string = ''\n    title: string = ''\n    position: [number, number] = [0, 0]\n    menuFont: string = ''\n    loFont: string = ''\n    hiFont: string = ''\n    itemCount: number = 0\n    menuImage: string = ''\n    autoCenter: boolean = false\n    displayTitle: boolean = false\n    overlays: any[] = []\n    playRandom: boolean = false\n    itemsLabel: MenuLabelItemCfg[] = []\n    itemsSlider: MenuSliderItemCfg[] = []\n    itemsCycle: MenuCycleItemCfg[] = []\n    anchored: boolean = false\n    canScroll: boolean = false\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    assignValue(objKey, lCfgKeyName, cfgValue): boolean {\n        if (lCfgKeyName.match(/item\\d+/i)) {\n            const lActionName = cfgValue[0].toLowerCase()\n            if (lActionName === 'next' || lActionName === 'trigger') {\n                this.itemsLabel.push(new MenuLabelItemCfg(cfgValue))\n            } else if (lActionName === 'slider') {\n                this.itemsSlider.push(new MenuSliderItemCfg(cfgValue))\n            } else if (lActionName === 'cycle') {\n                this.itemsCycle.push(new MenuCycleItemCfg(cfgValue))\n            } else {\n                console.warn('Unexpected item action name: ' + cfgValue[0])\n                return false\n            }\n            return true\n        } else if (lCfgKeyName.match(/overlay\\d+/i)) {\n            this.overlays.push(cfgValue)\n            return true\n        }\n        return super.assignValue(objKey, lCfgKeyName, cfgValue)\n    }\n\n    parseValue(lCfgKeyName: string, cfgValue: any): any {\n        if (lCfgKeyName === 'fullName'.toLowerCase() || lCfgKeyName === 'title') {\n            return cfgValue.replace(/_/g, ' ')\n        } else {\n            return super.parseValue(lCfgKeyName, cfgValue)\n        }\n    }\n\n}\n","import { BaseConfig } from './BaseConfig'\nimport { MenuEntryCfg } from './MenuEntryCfg'\n\nexport class MenuCfg extends BaseConfig {\n\n    menuCount: number = 0\n    menus: MenuEntryCfg[] = []\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    assignValue(objKey, lCfgKeyName, cfgValue): boolean {\n        if (lCfgKeyName.match(/menu\\d+/i)) {\n            this.menus.push(new MenuEntryCfg(cfgValue))\n            return true\n        }\n        return super.assignValue(objKey, lCfgKeyName, cfgValue)\n    }\n\n}\n","import { BaseConfig } from './BaseConfig'\n\nexport class RewardCfg extends BaseConfig {\n\n    display: boolean = true\n    wallpaper: string = ''\n    images: RewardImageCfg[] = []\n    texts: RewardTextCfg[] = []\n    boxImages: RewardImageCfg[] = []\n    fonts: RewardFontsCfg = null\n    flics: { flhFilepath: string, x: number, y: number, w: number, h: number } = null\n    scrollSpeed: number = 0\n    centreText: boolean = false\n    vertSpacing: number = 0\n    backFont: string = ''\n    font: string = ''\n    titleFont: string = ''\n    timer: number = 0\n    saveButton: any = ''\n    advanceButton: any = ''\n    completeText: string = ''\n    failedText: string = ''\n    quitText: string = ''\n    textPos: [number, number] = [0, 0]\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    assignValue(objKey, lCfgKeyName, cfgValue): boolean {\n        if (lCfgKeyName === 'images') {\n            Object.values(cfgValue).forEach((imgConf) => this.images.push(new RewardImageCfg(imgConf)))\n            return true\n        } else if (lCfgKeyName === 'text') {\n            Object.values(cfgValue).forEach((imgConf) => this.texts.push(new RewardTextCfg(imgConf)))\n            return true\n        } else if (lCfgKeyName === 'boximages') {\n            Object.values(cfgValue).forEach((imgConf) => this.boxImages.push(new RewardImageCfg(imgConf)))\n            return true\n        } else if (lCfgKeyName === 'fonts') {\n            this.fonts = new RewardFontsCfg(cfgValue)\n            return true\n        } else {\n            return super.assignValue(objKey, lCfgKeyName, cfgValue)\n        }\n    }\n\n}\n\nexport class RewardImageCfg {\n\n    filePath: string = ''\n    x: number = 0\n    y: number = 0\n\n    constructor(cfgObj: any) {\n        [this.filePath, this.x, this.y] = cfgObj\n    }\n\n}\n\nexport class RewardTextCfg {\n\n    text: string = ''\n    x: number = 0\n    y: number = 0\n\n    constructor(cfgObj: any) {\n        [this.text, this.x, this.y] = cfgObj\n    }\n\n}\n\nexport class RewardFontsCfg extends BaseConfig {\n\n    crystals: string = ''\n    ore: string = ''\n    diggable: string = ''\n    constructions: string = ''\n    caverns: string = ''\n    figures: string = ''\n    rockMonsters: string = ''\n    oxygen: string = ''\n    timer: string = ''\n    score: string = ''\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n}\n","// The RockRaidersObjectNotation (RON) format is related to JSON\n\nexport class RonFileParser {\n\n    static parse(content: string) {\n        const lines: string[][] = content.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n') // normalize newlines\n            .replace(/\\t/g, ' ') // tabs to spaces\n            .split('\\n')\n            .map((l) => { // strip comments from each line\n                const indDoubleSlash = l.indexOf('//')\n                if (indDoubleSlash > -1) l = l.substring(0, indDoubleSlash)\n                const indComment = l.indexOf(';')\n                if (indComment > -1) l = l.substring(0, indComment)\n                return l\n            })\n            .map((l) => { // remove whitespace at start/end of lines\n                l = l.trim()\n                return l\n            })\n            .filter(l => l !== '') // filter empty lines\n            .map((v) => v.split(' ').filter(v => v !== ''))\n        const root = {}\n        RonFileParser.parseObj(root, lines, 0)\n        return root\n    }\n\n    static parseObj(obj: {}, lines: string[][], start): number {\n        for (let c = start; c < lines.length; c++) {\n            const [name, val] = lines[c]\n            const key = name.toLowerCase()\n            if (val === '{') {\n                obj[key] = {}\n                c = this.parseObj(obj[key], lines, c + 1)\n            } else if (key === '}') {\n                return c\n            } else {\n                // parse values\n                let value: any = val.split(':').filter(v => v !== '') // there is key::value\n                    .map(v => v.split(',').map(v => v.split('|').map(v => this.parseValue(v))))\n                while (value.length === 1) value = value[0] // replace arrays with only one value\n                obj[key] = value\n            }\n        }\n        return lines.length\n    }\n\n    static parseValue(value: string) {\n        const num = Number(value)\n        const lv = value.toLowerCase()\n        if (!isNaN(num)) {\n            return num\n        } else if (lv === 'false') {\n            return false\n        } else if (lv === 'true') {\n            return true\n        } else {\n            return value\n        }\n    }\n\n}\n","import { LevelEntryCfg, LevelsCfg } from '../../cfg/LevelsCfg'\nimport { MenuCfg } from '../../cfg/MenuCfg'\nimport { RewardCfg } from '../../cfg/RewardCfg'\nimport { getFilename, getPath, iGet } from '../../core/Util'\nimport { RonFileParser } from './parser/RonFileParser'\nimport { WadLoader } from './WadLoader'\n\ninterface WadAsset {\n    method: ((name: string, callback: (assetName: string[], assetData: any) => void) => void)\n    assetPath: string\n    optional: boolean\n    sfxKeys: string[]\n}\n\nexport class WadAssetRegistry extends Map<string, WadAsset> {\n\n    wadLoader: WadLoader\n\n    constructor(wadLoader: WadLoader) {\n        super()\n        this.wadLoader = wadLoader\n    }\n\n    registerAllAssets(mainConf: any) {\n        // add fonts and cursors\n        this.addAssetFolder(this.wadLoader.loadFontImageAsset, 'Interface/Fonts/')\n        this.addAssetFolder(this.wadLoader.loadAlphaImageAsset, 'Interface/Pointers/')\n        this.wadLoader.wad0File.filterEntryNames('Interface/Pointers/' + '.+\\\\.flh').forEach((assetPath) => {\n            this.addAsset(this.wadLoader.loadFlhAsset, assetPath)\n        })\n        // add menu assets\n        this.addMenuWithAssets(mainConf, 'MainMenuFull', false)\n        this.addMenuWithAssets(mainConf, 'PausedMenu')\n        this.addMenuWithAssets(mainConf, 'OptionsMenu')\n        this.addAsset(this.wadLoader.loadAlphaImageAsset, 'Interface/BriefingPanel/BriefingPanel.bmp')\n        this.addAsset(this.wadLoader.loadObjectiveTexts, 'Languages/ObjectiveText.txt')\n        // add in-game assets\n        this.addAlphaImageFolder('Interface/TopPanel/') // top panel\n        this.addAlphaImageFolder('Interface/RightPanel/') // crystal side bar\n        this.addAlphaImageFolder('Interface/RadarPanel/')\n        this.addAlphaImageFolder('Interface/MessagePanel/')\n        this.addAsset(this.wadLoader.loadWadImageAsset, 'Interface/Airmeter/msgpanel_air_juice.bmp')\n        this.addAlphaImageFolder('Interface/InfoPanel/')\n        this.addAlphaImageFolder('Interface/PriorityPanel/')\n        this.addAlphaImageFolder('Interface/Priorities')\n        this.addAlphaImageFolder('Interface/CameraControl/')\n        this.addAlphaImageFolder('Interface/MessageTabs/')\n        this.addAlphaImageFolder('Interface/IconPanel/')\n        this.addAlphaImageFolder('Interface/Icons/')\n        this.addAlphaImageFolder('Interface/Menus/')\n        this.addAlphaImageFolder('Interface/Buttons/')\n        this.addAlphaImageFolder('Interface/InfoImages/')\n        this.addAssetFolder(this.wadLoader.loadAlphaImageAsset, 'Interface/FrontEnd/Vol_')\n        this.addAssetFolder(this.wadLoader.loadWadImageAsset, 'Interface/FrontEnd/lp_')\n        this.addAsset(this.wadLoader.loadAlphaImageAsset, 'Interface/FrontEnd/LowerPanel.bmp')\n        // level files\n        this.addAsset(this.wadLoader.loadNerpAsset, 'Levels/nerpnrn.h')\n        const levelsCfg = new LevelsCfg(iGet(mainConf, 'Levels'))\n        this.wadLoader.onAssetLoaded(0, ['Levels'], levelsCfg)\n        Object.values(levelsCfg.levelsByName).forEach((level: LevelEntryCfg) => {\n            level.menuBMP.forEach((bmpName) => {\n                this.addAsset(this.wadLoader.loadAlphaImageAsset, bmpName)\n            })\n            this.addAsset(this.wadLoader.loadMapAsset, level.surfaceMap)\n            this.addAsset(this.wadLoader.loadMapAsset, level.predugMap)\n            this.addAsset(this.wadLoader.loadMapAsset, level.terrainMap)\n            this.addAsset(this.wadLoader.loadMapAsset, level.blockPointersMap, true)\n            this.addAsset(this.wadLoader.loadMapAsset, level.cryOreMap)\n            this.addAsset(this.wadLoader.loadMapAsset, level.pathMap, true)\n            if (level.fallinMap) this.addAsset(this.wadLoader.loadMapAsset, level.fallinMap)\n            if (level.erodeMap) this.addAsset(this.wadLoader.loadMapAsset, level.erodeMap)\n            this.addAsset(this.wadLoader.loadObjectListAsset, level.oListFile)\n            this.addAsset(this.wadLoader.loadNerpAsset, level.nerpFile)\n            this.addAsset(this.wadLoader.loadNerpMsg, level.nerpMessageFile)\n        })\n        // load all shared textures\n        this.addTextureFolder('World/Shared/')\n        this.addTextureFolder('Vehicles/SharedUG/')\n        // load all entity upgrades\n        const upgradeTypes = iGet(mainConf, 'UpgradeTypes')\n        Object.values(upgradeTypes).forEach((uType: string) => {\n            this.addMeshObjects(uType)\n        })\n        // load all building types\n        const buildingTypes = iGet(mainConf, 'BuildingTypes')\n        Object.values(buildingTypes).forEach((bType: string) => {\n            this.addMeshObjects(bType)\n        })\n        this.addAnimatedEntity('mini-figures/pilot/pilot.ae')\n        // load monsters\n        const rockMonsterTypes = iGet(mainConf, 'RockMonsterTypes')\n        Object.values(rockMonsterTypes).forEach((mType: string) => {\n            this.addMeshObjects(mType)\n        })\n        // load vehicles\n        const vehicleTypes = mainConf['VehicleTypes']\n        Object.values(vehicleTypes).forEach((v) => {\n            (Array.isArray(v) ? v : [v]).forEach((vType: string) => {\n                this.addMeshObjects(vType)\n            })\n        })\n        // load misc objects\n        this.addTextureFolder('MiscAnims/Crystal/')\n        this.addAsset(this.wadLoader.loadLWOFile, 'World/Shared/Crystal.lwo') // high-poly version\n        this.addAsset(this.wadLoader.loadWadTexture, 'MiscAnims/Ore/Ore.bmp')\n        this.addTextureFolder('MiscAnims/RockFall/')\n        this.addLWSFile('MiscAnims/RockFall/Rock3Sides.lws')\n        const miscObjects = mainConf['MiscObjects']\n        Object.values(miscObjects).forEach((mType: string) => {\n            this.addMeshObjects(mType)\n        })\n        // spaces\n        this.addTextureFolder('World/WorldTextures/IceSplit/Ice')\n        this.addTextureFolder('World/WorldTextures/LavaSplit/Lava')\n        this.addTextureFolder('World/WorldTextures/RockSplit/Rock')\n        // reward screen\n        const rewardCfg = new RewardCfg(iGet(mainConf, 'Reward'))\n        this.wadLoader.onAssetLoaded(0, ['Reward'], rewardCfg)\n        this.addAsset(this.wadLoader.loadWadImageAsset, rewardCfg.wallpaper)\n        this.addAsset(this.wadLoader.loadFontImageAsset, rewardCfg.backFont)\n        Object.values(rewardCfg.fonts).forEach(imgPath => this.addAsset(this.wadLoader.loadFontImageAsset, imgPath))\n        rewardCfg.images.forEach(img => this.addAsset(this.wadLoader.loadAlphaImageAsset, img.filePath))\n        rewardCfg.boxImages.forEach(img => this.addAsset(this.wadLoader.loadWadImageAsset, img.filePath))\n        rewardCfg.saveButton.splice(0, 4).forEach(img => this.addAsset(this.wadLoader.loadWadImageAsset, img))\n        rewardCfg.advanceButton.splice(0, 4).forEach(img => this.addAsset(this.wadLoader.loadWadImageAsset, img))\n        // sounds\n        const sndPathToKeys = new Map<string, string[]>()\n        const samplesConf = mainConf['Samples']\n        Object.keys(samplesConf).forEach((sndKey) => {\n            const value = samplesConf[sndKey]\n            sndKey = sndKey.toLowerCase()\n            if (sndKey === '!sfx_drip') {\n                return // Sounds/dripB.wav missing and seems unused anyway\n            } else if (sndKey.startsWith('!')) { // TODO no clue what this means... loop? duplicate?!\n                sndKey = sndKey.slice(1)\n            }\n            const sndFilePaths = Array.isArray(value) ? value : [value]\n            sndFilePaths.forEach(sndPath => {\n                if (sndPath.startsWith('*')) { // TODO no clue what this means... don't loop maybe, see telportup\n                    sndPath = sndPath.slice(1)\n                } else if (sndPath.startsWith('@')) {\n                    // sndPath = sndPath.slice(1)\n                    // console.warn('Sound ' + sndPath + ' must be loaded from program files folder. Not yet implemented!')\n                    return // TODO implement sounds from program files folder\n                }\n                sndPathToKeys.getOrUpdate(sndPath + '.wav', () => []).push(sndKey)\n            })\n        })\n        sndPathToKeys.forEach((sndKeys, sndPath) => {\n            this.addAsset(this.wadLoader.loadWavAsset, sndPath, false, sndKeys)\n        })\n    }\n\n    addMeshObjects(basePath: string) {\n        const aeFilepath = basePath + '/' + basePath.split('/').last() + '.ae'\n        if (this.wadLoader.wad0File.hasEntry(aeFilepath)) this.addAnimatedEntity(aeFilepath)\n        const aeSharedFilepath = 'world/shared/' + basePath.split('/').last() + '.ae'\n        if (this.wadLoader.wad0File.hasEntry(aeSharedFilepath)) this.addAnimatedEntity(aeSharedFilepath)\n        const lwsFilepath = basePath + '.lws'\n        if (this.wadLoader.wad0File.hasEntry(lwsFilepath)) this.addLWSFile(lwsFilepath)\n        const lwsSharedFilepath = 'world/shared/' + basePath.split('/').last() + '.lws'\n        if (this.wadLoader.wad0File.hasEntry(lwsSharedFilepath)) this.addLWSFile(lwsSharedFilepath)\n        const lwoFilepath = basePath + '.lwo'\n        if (this.wadLoader.wad0File.hasEntry(lwoFilepath)) this.addAsset(this.wadLoader.loadLWOFile, lwoFilepath)\n        const lwoSharedFilepath = 'world/shared/' + basePath.split('/').last() + '.lwo'\n        if (this.wadLoader.wad0File.hasEntry(lwoSharedFilepath)) this.addAsset(this.wadLoader.loadLWOFile, lwoSharedFilepath)\n    }\n\n    addAnimatedEntity(aeFile: string) {\n        const content = this.wadLoader.wad0File.getEntryText(aeFile)\n        const cfgRoot = iGet(RonFileParser.parse(content), 'Lego*')\n        this.wadLoader.onAssetLoaded(0, [aeFile], cfgRoot)\n        const path = getPath(aeFile)\n        // load all textures for this type\n        this.addTextureFolder(path)\n        const wheelMeshName = iGet(cfgRoot, 'WheelMesh')\n        if (wheelMeshName && !'NULL_OBJECT'.equalsIgnoreCase(wheelMeshName)) {\n            this.addAsset(this.wadLoader.loadLWOFile, path + wheelMeshName + '.lwo')\n        }\n        ['HighPoly', 'MediumPoly', 'LowPoly'].forEach((polyType) => { // TODO add 'FPPoly' (contains two cameras)\n            const cfgPoly = iGet(cfgRoot, polyType)\n            if (cfgPoly) {\n                Object.keys(cfgPoly).forEach((key) => {\n                    this.addAsset(this.wadLoader.loadLWOFile, path + cfgPoly[key] + '.lwo')\n                })\n            }\n        })\n        Object.keys(cfgRoot).forEach((cfgKey) => {\n            try {\n                const value = cfgRoot[cfgKey]\n                const isLws = iGet(value, 'LWSFILE') === true\n                if (isLws) {\n                    const file = iGet(value, 'FILE')\n                    this.addLWSFile(path + file + '.lws')\n                }\n            } catch (e) {\n                // XXX do we have to care? files listed in pilot.ae can be found in vehicles/hoverboard/...\n            }\n        })\n    }\n\n    addLWSFile(lwsFilepath: string) {\n        const content = this.wadLoader.wad0File.getEntryText(lwsFilepath)\n        this.wadLoader.onAssetLoaded(0, [lwsFilepath], content)\n        const lwoFiles: string[] = this.extractLwoFiles(getPath(lwsFilepath), content)\n        lwoFiles.forEach((lwoFile) => this.addAsset(this.wadLoader.loadLWOFile, lwoFile))\n    }\n\n    extractLwoFiles(path: string, content: string): string[] {\n        const lines: string[] = content.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n') // normalize newlines\n            .replace(/\\t/g, ' ') // tabs to spaces\n            .split('\\n')\n            .map((l) => l.trim())\n\n        if (lines[0] !== 'LWSC') {\n            throw 'Invalid start of file! Expected \\'LWSC\\' in first line'\n        }\n\n        return lines.filter((line) => line.toLowerCase().startsWith('LoadObject '.toLowerCase()))\n            .map((objLine) => path + getFilename(objLine.substring('LoadObject '.length)).toLowerCase())\n    }\n\n    addAlphaImageFolder(folderPath: string) {\n        this.addAssetFolder(this.wadLoader.loadAlphaImageAsset, folderPath)\n    }\n\n    addTextureFolder(folderPath: string) {\n        this.addAssetFolder(this.wadLoader.loadWadTexture, folderPath)\n    }\n\n    addAssetFolder(callback: (name: string, callback: (assetNames: string[], obj: any) => any) => void, folderPath) {\n        this.wadLoader.wad0File.filterEntryNames(folderPath + '.+\\\\.bmp').forEach((assetPath) => {\n            this.addAsset(callback, assetPath)\n        })\n    }\n\n    addMenuWithAssets(mainConf, name: string, menuImageAlpha: boolean = true) {\n        const menuCfg = new MenuCfg(iGet(mainConf, 'Menu', name))\n        this.wadLoader.onAssetLoaded(0, [name], menuCfg)\n        menuCfg.menus.forEach((menuCfg) => {\n            const method = menuImageAlpha ? this.wadLoader.loadAlphaImageAsset : this.wadLoader.loadWadImageAsset\n            const menuImage = Array.isArray(menuCfg.menuImage) ? menuCfg.menuImage[0] : menuCfg.menuImage\n            this.addAsset(method, menuImage)\n            this.addAsset(this.wadLoader.loadFontImageAsset, menuCfg.menuFont)\n            this.addAsset(this.wadLoader.loadFontImageAsset, menuCfg.loFont)\n            this.addAsset(this.wadLoader.loadFontImageAsset, menuCfg.hiFont)\n        })\n    }\n\n    addAsset(method: (name: string, callback: (assetNames: string[], assetData: any) => void) => void, assetPath: string, optional = false, sfxKeys: string[] = []) {\n        if (!assetPath || this.hasOwnProperty(assetPath) || assetPath === 'NULL') {\n            return // do not load assets twice\n        }\n        this.set(assetPath, {\n            method: method.bind(this.wadLoader),\n            assetPath: assetPath,\n            optional: optional,\n            sfxKeys: sfxKeys,\n        })\n    }\n\n}\n","import { encodeChar } from './parser/EncodingHelper'\n\n/**\n * Handles the extraction of single files from a bigger WAD data blob\n */\nexport class WadFile {\n\n    buffer: Int8Array = null\n    entryIndexByName: Map<string, number> = new Map()\n    fLength: number[] = []\n    fStart: number[] = []\n\n    /**\n     * Validate and parse the given data object as binary blob of a WAD file\n     * @param data binary blob\n     * @param debug enable/disable debug output while parsing\n     */\n    parseWadFile(data, debug = false) {\n        const dataView = new DataView(data)\n        this.buffer = new Int8Array(data)\n        let pos = 0\n        if (String.fromCharCode.apply(null, this.buffer.slice(pos, 4)) !== 'WWAD') {\n            throw 'Invalid WAD0 file provided'\n        }\n        if (debug) {\n            console.log('WAD0 file seems legit')\n        }\n        pos = 4\n        const numberOfEntries = dataView.getInt32(pos, true)\n        if (debug) {\n            console.log(numberOfEntries)\n        }\n        pos = 8\n\n        let bufferStart = pos\n        for (let i = 0; i < numberOfEntries; pos++) {\n            if (this.buffer[pos] === 0) {\n                this.entryIndexByName.set(String.fromCharCode.apply(null, this.buffer.slice(bufferStart, pos)).replace(/\\\\/g, '/').toLowerCase(), i)\n                bufferStart = pos + 1\n                i++\n            }\n        }\n\n        if (debug) {\n            console.log(this.entryIndexByName)\n        }\n\n        for (let i = 0; i < numberOfEntries; pos++) {\n            if (this.buffer[pos] === 0) {\n                bufferStart = pos + 1\n                i++\n            }\n        }\n\n        if (debug) {\n            console.log('Offset after absolute original names is ' + pos)\n        }\n\n        for (let i = 0; i < numberOfEntries; i++) {\n            this.fLength[i] = dataView.getInt32(pos + 8, true)\n            this.fStart[i] = dataView.getInt32(pos + 12, true)\n            pos += 16\n        }\n\n        if (debug) {\n            console.log(this.fLength)\n            console.log(this.fStart)\n        }\n    }\n\n    /**\n     * Returns the entries content extracted by name from the managed WAD file\n     * @param entryName Entry name to be extracted\n     * @returns {Uint8Array} Returns the content as Uint8Array\n     */\n    getEntryData(entryName): Uint8Array {\n        return new Uint8Array(this.getEntryBuffer(entryName))\n    }\n\n    /**\n     * Returns the entries content as text extracted by name from the managed WAD file\n     * @param entryName Entry name to be extracted\n     * @returns {string} Returns the content as String\n     */\n    getEntryText(entryName): string {\n        let result = ''\n        this.getEntryData(entryName).forEach((c) => result += String.fromCharCode(encodeChar[c]))\n        return result\n    }\n\n    /**\n     * Returns the entries content by name extracted from the managed WAD file\n     * @param entryName Entry name to be extracted\n     * @returns {ArrayBufferLike} Returns the content as buffer slice\n     */\n    getEntryBuffer(entryName): ArrayBufferLike {\n        const index = this.entryIndexByName.get(entryName.toLowerCase())\n        if (index === undefined || index === null) {\n            throw 'Entry \\'' + entryName + '\\' not found in WAD file'\n        }\n        return this.buffer.slice(this.fStart[index], this.fStart[index] + this.fLength[index]).buffer\n    }\n\n    filterEntryNames(regexStr) {\n        const regex = new RegExp(regexStr.toLowerCase())\n        const result = []\n        this.entryIndexByName.forEach((index, entry) => {\n            if (entry.match(regex)) result.push(entry)\n        })\n        return result\n    }\n\n    hasEntry(entryName: string): boolean {\n        const index = this.entryIndexByName.get(entryName.toLowerCase())\n        return index !== undefined && index !== null\n    }\n\n}\n","import { getFilename, iGet } from '../../core/Util'\nimport { WAD_CACHE_DB_NAME } from '../../params'\nimport { FlhParser } from '../FlhParser'\nimport { BitmapWithPalette } from './parser/BitmapWithPalette'\nimport { CfgFileParser } from './parser/CfgFileParser'\nimport { NerpMsgParser } from './parser/NerpMsgParser'\nimport { ObjectiveTextParser } from './parser/ObjectiveTextParser'\nimport { WadParser } from './parser/WadParser'\nimport { WadAssetRegistry } from './WadAssetRegistry'\nimport { WadFile } from './WadFile'\nimport { grayscaleToGreen } from './WadUtil'\n\nexport class WadLoader {\n\n    wad0File: WadFile = null\n    wad1File: WadFile = null\n    startTime: Date\n    assetIndex: number = 0\n    totalResources: number = 0\n    assetRegistry: WadAssetRegistry = new WadAssetRegistry(this)\n\n    onMessage: (msg: string) => any = (msg: string) => {\n        console.log(msg)\n    }\n    onInitialLoad: (totalResources: number, cfg: any) => any = () => {\n        console.log('Initial loading done.')\n    }\n    onAssetLoaded: (assetIndex: number, assetNames: string[], assetObj: any, sfxKeys?: string[]) => any = () => {\n    }\n    onLoadDone: (totalResources: number, loadingTimeSeconds: string) => any = (totalResources: number, loadingTimeSeconds: string) => {\n        console.log('Loading of about ' + totalResources + ' assets complete! Total load time: ' + loadingTimeSeconds + ' seconds.')\n    }\n\n    loadWadImageAsset(name: string, callback: (assetNames: string[], obj: ImageData) => any) {\n        const data = this.wad0File.getEntryData(name)\n        const imgData = BitmapWithPalette.decode(data)\n        callback([name], imgData)\n    }\n\n    loadWadTexture(name: string, callback: (assetNames: string[], obj: ImageData) => any) {\n        const data = this.wad0File.getEntryData(name)\n        const alphaIndexMatch = name.toLowerCase().match(/(.*a)(\\d+)(_.+)/)\n        let alphaIndex = null\n        const assetNames = [name]\n        if (alphaIndexMatch) {\n            assetNames.push(alphaIndexMatch[1] + alphaIndexMatch[3])\n            alphaIndex = parseInt(alphaIndexMatch[2])\n        }\n        const imgData = BitmapWithPalette.decode(data).applyAlphaByIndex(alphaIndex)\n        if (name.toLowerCase().startsWith('miscanims/crystal')) { // XXX fix crystal lwo loading\n            callback(assetNames, grayscaleToGreen(imgData))\n        } else {\n            callback(assetNames, imgData)\n        }\n    }\n\n    loadAlphaImageAsset(name: string, callback: (assetNames: string[], obj: ImageData) => any) {\n        const data = this.wad0File.getEntryData(name)\n        const imgData = BitmapWithPalette.decode(data).applyAlpha()\n        const assetNames = [name]\n        const alphaIndexMatch = name.toLowerCase().match(/(.*a)(\\d+)(_.+)/)\n        if (alphaIndexMatch) assetNames.push(alphaIndexMatch[1] + alphaIndexMatch[3])\n        callback(assetNames, imgData)\n    }\n\n    loadFontImageAsset(name: string, callback: (assetNames: string[], obj: ImageData) => any) {\n        const data = this.wad0File.getEntryData(name)\n        const imgData = BitmapWithPalette.decode(data)\n        callback([name], imgData)\n    }\n\n    loadNerpAsset(name: string, callback: (assetNames: string[], obj: string) => any) {\n        const nrnName = name.replace(/\\.npl$/, '.nrn')\n        const script = this.wad0File.getEntryText(nrnName)\n        callback([name, nrnName], script)\n    }\n\n    loadNerpMsg(name: string, callback: (assetNames: string[], obj: any) => any) {\n        const wad0Data = this.wad0File.getEntryText(name)\n        const wad1Data = this.wad1File.getEntryText(name)\n        const result = NerpMsgParser.parseNerpMessages(wad0Data, wad1Data)\n        callback([name], result)\n    }\n\n    loadObjectiveTexts(name: string, callback: (assetNames: string[], obj: any) => any) {\n        const txtContent = this.wad1File.getEntryData(name)\n        const result = new ObjectiveTextParser().parseObjectiveTextFile(txtContent)\n        callback([name], result)\n    }\n\n    loadMapAsset(name: string, callback: (assetNames: string[], obj: any) => any) {\n        const buffer = this.wad0File.getEntryData(name)\n        if (buffer.length < 13 || String.fromCharCode.apply(String, buffer.slice(0, 3)) !== 'MAP') {\n            console.error('Invalid map data provided for: ' + name)\n            return\n        }\n        const map = WadParser.parseMap(buffer)\n        callback([name], map)\n    }\n\n    loadObjectListAsset(name: string, callback: (assetNames: string[], obj: any) => any) {\n        const data = this.wad0File.getEntryText(name)\n        const objectList = WadParser.parseObjectList(data)\n        callback([name], objectList)\n    }\n\n    /**\n     * Load a WAV file format sound asset from the WAD file.\n     * @param path Path inside the WAD file\n     * @param callback A callback that is triggered after the file has been loaded\n     */\n    loadWavAsset(path: string, callback: (assetNames: string[], obj: any) => any) {\n        let buffer: ArrayBufferLike\n        try { // localized wad1 file first, then generic wad0 file\n            buffer = this.wad1File.getEntryBuffer(path)\n        } catch (e) {\n            buffer = this.wad0File.getEntryBuffer(path)\n        }\n        callback([path], buffer)\n    }\n\n    loadLWOFile(lwoFilepath: string, callback: (assetNames: string[], obj: any) => any) {\n        let lwoContent\n        try {\n            lwoContent = this.wad0File.getEntryBuffer(lwoFilepath)\n        } catch (e) {\n            try {\n                lwoContent = this.wad0File.getEntryBuffer('world/shared/' + getFilename(lwoFilepath))\n            } catch (e) {\n                if (!lwoFilepath.equalsIgnoreCase('Vehicles/BullDozer/VLBD_light.lwo') // ignore known issues\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/LD_bucket.lwo')\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/LD_main.lwo')\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/LD_C_Pit.lwo')\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/LD_Light01.lwo')\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/digbodlight.lwo')\n                    && !lwoFilepath.equalsIgnoreCase('Vehicles/LargeDigger/LD_PipeL.lwo')) {\n                    console.error('Could not load LWO file ' + lwoFilepath + '; Error: ' + e)\n                }\n                lwoContent = {}\n            }\n        }\n        callback([lwoFilepath], lwoContent)\n    }\n\n    loadFlhAsset(filename: string, callback: (assetNames: string[], obj: any) => any) {\n        const flhContent = this.wad0File.getEntryBuffer(filename)\n        const flhFrames = new FlhParser().parse(flhContent)\n        callback([filename], flhFrames)\n    }\n\n    loadAssetsParallel() {\n        const promises = []\n        const that = this\n        this.assetRegistry.forEach((asset) => {\n            promises.push(new Promise<void>((resolve) => {\n                try {\n                    asset.method(asset.assetPath, (assetNames, assetObj) => {\n                        this.assetIndex++\n                        that.onAssetLoaded(this.assetIndex, assetNames, assetObj, asset.sfxKeys)\n                        resolve()\n                    })\n                } catch (e) {\n                    if (!asset.optional) console.error(e)\n                    this.assetIndex++\n                    that.onAssetLoaded(this.assetIndex, [asset.assetPath], null, asset.sfxKeys)\n                    resolve()\n                }\n            }))\n        })\n        Promise.all(promises).then(() => {\n            // indicate that loading has finished, and display the total loading time\n            const loadingTimeSeconds = ((new Date().getTime() - this.startTime.getTime()) / 1000).toFixed(3).toString()\n            this.onLoadDone(this.totalResources, loadingTimeSeconds)\n        })\n    }\n\n    startWithCachedFiles(onCacheMiss: () => any) {\n        this.startTime = new Date()\n        const _onerror = () => {\n            this.onMessage('WAD files not found in cache')\n            onCacheMiss()\n        }\n        this.onMessage('Loading WAD files from cache...')\n        const that = this\n        this.openLocalCache((objectStore) => {\n            const request1 = objectStore.get('wad0')\n            request1.onerror = _onerror\n            request1.onsuccess = function () {\n                if (request1.result === undefined) {\n                    _onerror()\n                    return\n                }\n                // console.log('First WAD file loaded from cache after ' + ((new Date().getTime() - that.startTime.getTime()) / 1000));\n                that.wad0File = new WadFile()\n                for (let prop in request1.result) { // class info are runtime info and not stored in cache => use copy constructor\n                    if (request1.result.hasOwnProperty(prop)) {\n                        that.wad0File[prop] = request1.result[prop]\n                    }\n                }\n                const request2 = objectStore.get('wad1')\n                request2.onerror = _onerror\n                request2.onsuccess = function () {\n                    if (request2.result === undefined) {\n                        _onerror()\n                        return\n                    }\n                    that.wad1File = new WadFile()\n                    for (let prop in request2.result) { // class info are runtime info and not stored in cache => use copy constructor\n                        if (request2.result.hasOwnProperty(prop)) {\n                            that.wad1File[prop] = request2.result[prop]\n                        }\n                    }\n                    console.log('WAD files loaded from cache after ' + ((new Date().getTime() - that.startTime.getTime()) / 1000))\n                    that.startLoadingProcess()\n                }\n            }\n        })\n    }\n\n    /**\n     * Private helper method, which combines file loading and waits for them to become ready before continuing\n     * @param wad0Url Url to parse the LegoRR0.wad file from\n     * @param wad1Url Url to parse the LegoRR1.wad file from\n     */\n    loadWadFiles(wad0Url: string, wad1Url: string) {\n        const that = this\n        Promise.all([this.loadWadFile(wad0Url), this.loadWadFile(wad1Url)]).then(wadFiles => {\n            that.wad0File = wadFiles[0] as WadFile\n            that.wad1File = wadFiles[1] as WadFile\n            this.openLocalCache((objectStore) => {\n                objectStore.put(that.wad0File, 'wad0')\n                objectStore.put(that.wad1File, 'wad1')\n            })\n            this.startLoadingProcess()\n        })\n    }\n\n    /**\n     * Read WAD file as binary blob from the given URL and parse it on success\n     * @param url the url to the WAD file, can be local file url (file://...) too\n     */\n    loadWadFile(url: string) {\n        return new Promise(resolve => {\n            console.log('Loading WAD file from ' + url)\n            fetch(url).then((response) => {\n                if (response.ok) {\n                    response.arrayBuffer().then((buffer) => {\n                        const wadFile = new WadFile()\n                        wadFile.parseWadFile(buffer)\n                        resolve(wadFile)\n                    })\n                }\n            }).catch((e) => console.error(e))\n        })\n    }\n\n    openLocalCache(onopen: (IDBObjectStore) => void) {\n        const request: IDBOpenDBRequest = indexedDB.open(WAD_CACHE_DB_NAME)\n        request.onupgradeneeded = function () {\n            const db = request.result\n            if (db.objectStoreNames.contains('wadfiles')) {\n                db.deleteObjectStore('wadfiles')\n            }\n            db.createObjectStore('wadfiles')\n        }\n        request.onsuccess = function () {\n            const db = request.result\n            const transaction = db.transaction(['wadfiles'], 'readwrite')\n            const objectStore = transaction.objectStore('wadfiles')\n            onopen(objectStore)\n        }\n    }\n\n    /**\n     * Load essential files, to begin the chain of asset loading\n     */\n    startLoadingProcess() {\n        this.startTime = new Date()\n        this.onMessage('Loading configuration...')\n        const cfg = CfgFileParser.parse(this.wad1File.getEntryData('Lego.cfg'))\n        // dynamically register all assets from config\n        this.assetRegistry.registerAllAssets(cfg)\n        this.onMessage('Loading initial assets...')\n        Promise.all([\n            new Promise<void>((resolve) => {\n                const name = iGet(cfg, 'Main', 'LoadScreen') // loading screen image\n                this.loadWadImageAsset(name, (assetNames: string[], imgData) => {\n                    this.onAssetLoaded(0, assetNames, imgData)\n                    resolve()\n                })\n            }),\n            new Promise<void>((resolve) => {\n                const name = iGet(cfg, 'Main', 'ProgressBar') // loading bar container image\n                this.loadWadImageAsset(name, (assetNames: string[], imgData) => {\n                    this.onAssetLoaded(0, assetNames, imgData)\n                    resolve()\n                })\n            }),\n            new Promise<void>((resolve) => {\n                const name = iGet(cfg, 'Pointers', 'Pointer_Standard')\n                this.loadAlphaImageAsset(name, (assetNames: string[], imgData) => {\n                    this.onAssetLoaded(0, assetNames, imgData)\n                    resolve()\n                })\n            }),\n            new Promise<void>((resolve) => {\n                const name = 'Interface/Fonts/Font5_Hi.bmp'\n                this.loadFontImageAsset(name, (assetNames: string[], imgData) => {\n                    this.onAssetLoaded(0, assetNames, imgData)\n                    resolve()\n                })\n            }),\n        ]).then(() => {\n            this.onMessage('Start loading assets...')\n            this.totalResources = this.assetRegistry.size\n            this.onInitialLoad(this.totalResources, cfg)\n            this.assetIndex = 0\n            this.loadAssetsParallel()\n        })\n    }\n\n}\n","export function grayscaleToGreen(imgData: ImageData): ImageData {\n    const arr = imgData.data\n    for (let c = 0; c < arr.length; c += 4) {\n        arr[c] = 0\n        arr[c + 2] = 0\n    }\n    return imgData\n}\n","interface NerpMessage {\n\n    txt?: string\n    snd?: string\n\n}\n\nexport class NerpMsgParser {\n\n    static parseNerpMessages(wad0Data: string, wad1Data: string): NerpMessage[] {\n        const result = this.parseNerpMsgFile(wad0Data, true)\n        const msg1 = this.parseNerpMsgFile(wad1Data, false)\n        for (let c = 0; c < msg1.length; c++) {\n            result[c] = result[c] || {}\n            const m1 = msg1[c]\n            if (!m1) continue\n            if (m1.txt) {\n                result[c].txt = m1.txt\n            }\n            if (m1.snd) {\n                result[c].snd = m1.snd\n            }\n        }\n        return result\n    }\n\n    static parseNerpMsgFile(wadData: string, isWad0File: boolean): NerpMessage[] {\n        const result = []\n        const lines = wadData.split(/[\\r\\n]/).map((l) => l?.trim()).filter((l) => !!l)\n        for (let c = 0; c < lines.length; c++) {\n            const line = lines[c]\n            if (line === '-') {\n                continue\n            }\n            // line formatting differs between wad0 and wad1 files!\n            const txt0Match = line.match(/\\\\\\[([^\\\\]+)\\\\](\\s*#([^#]+)#)?/)\n            const txt1Match = line.match(/^([^$][^#]+)(\\s*#([^#]+)#)?/)\n            const sndMatch = line.match(/\\$([^\\s]+)\\s*([^\\s]+)/)\n            if (isWad0File && txt0Match) {\n                const index = txt0Match[3] !== undefined ? this.numericNameToNumber(txt0Match[3]) : c // THIS IS MADNESS! #number# at the end of line is OPTIONAL\n                result[index] = result[index] || {}\n                result[index].txt = txt0Match[1]\n            } else if (!isWad0File && txt1Match) {\n                const index = txt1Match[3] !== undefined ? this.numericNameToNumber(txt1Match[3]) : c // THIS IS MADNESS! #number# at the end of line is OPTIONAL\n                result[index] = result[index] || {}\n                result[index].txt = txt1Match[1].replace(/_/g, ' ').trim()\n            } else if (sndMatch && sndMatch.length === 3) {\n                const index = this.numericNameToNumber(sndMatch[1])\n                result[index] = result[index] || {}\n                result[index].snd = sndMatch[2].replace(/\\\\/g, '/')\n            } else {\n                throw 'Line in nerps message file did not match anything'\n            }\n        }\n        return result\n    }\n\n    static numericNameToNumber(name: string): number {\n        if (name === undefined) {\n            throw 'Numeric name must not be undefined'\n        }\n        const digits = {one: 1, two: 2, three: 3, four: 4, five: 5, six: 6, seven: 7, eight: 8, nine: 9}\n        const specials = {\n            ten: 10, eleven: 11, twelve: 12, thirteen: 13, fourteen: 14, fifteen: 15,\n            sixteen: 16, seventeen: 17, eighteen: 18, nineteen: 19,\n            eightteen: 18, // typo seen in the wild\n        }\n        const tens = {twenty: 20, thirty: 30, forty: 40}\n        let number = specials[name] || digits[name]\n        if (number === undefined) {\n            Object.keys(tens).forEach(ten => {\n                if (name.startsWith(ten)) {\n                    const digitName = name.replace(ten, '')\n                    number = tens[ten] + (digitName ? digits[digitName] : 0)\n                }\n            })\n        }\n        if (number === undefined) {\n            throw 'Found unexpected numeric name ' + name\n        }\n        return number\n    }\n\n}\n","import { BaseConfig } from './BaseConfig'\n\nexport class BuildingEntityStats extends BaseConfig {\n\n    Levels: number = 0\n    SelfPowered: boolean = false\n    PowerBuilding: boolean = false\n    PickSphere: number = 0\n    TrainDynamite: boolean[] = null\n    CostOre: number = 0\n    CostCrystal: number = 0\n    OxygenCoef: number = 0\n    EngineSound: string = null\n\n}\n","// noinspection JSUnusedGlobalSymbols\n\nimport { BaseConfig } from './BaseConfig'\nimport { BuildingEntityStats } from './BuildingEntityStats'\n\nexport class GameStatsCfg extends BaseConfig {\n\n    Pilot = new class PilotStats extends BaseConfig {\n        Levels: number = 4\n        RouteSpeed: number[] = [1.10, 1.10, 1.10, 1.10]\n        SoilDrillTime: number[] = [4.0, 4.0, 4.0, 4.0] // Time in seconds to drill through the rock.\n        LooseDrillTime: number[] = [4.0, 4.0, 4.0, 4.0]\n        MedDrillTime: number[] = [8.0, 8.0, 8.0, 8.0]\n        HardDrillTime: number[] = [0.0, 0.0, 0.0, 0.0] // Zero means the object cannot drill the rock type\n        SeamDrillTime: number[] = [10.0, 10.0, 10.0, 10.0] // Either or both ore or crystal.\n        UpgradeTime: number[] = [30.0, 45.0, 60.0, 60.0] // Last entry is ignored as it can never upgrade from that.\n        CollRadius: number = 5.0\n        CollHeight: number = 12.0\n        TrackDist: number = 40.0\n        SingleWidthDig: boolean[] = [true, true, true, true]\n        PickSphere: number = 10.0\n        RepairValue: number[] = [10.0, 15.0, 20.0, 25.0]\n        SurveyRadius: number[] = [3, 3, 3, 3]\n        Drillsound: string = 'SND_pilotdrill'\n        Drillfadesound: string = 'SND_pilotdrillfade'\n        RestPercent: number = 60.0\n        EnergyDecayRate: number = 0.25\n        CanClearRubble: boolean = true\n        NumOfToolsCanCarry: number[] = [2, 3, 4, 5]\n        CrossLand: boolean = true\n        RubbleCoef: number = 0.5\n        PathCoef: number = 2.0\n        RouteAvoidance: boolean = true\n        UseLegoManTeleporter: boolean = true\n        AwarenessRange: number = 10.0\n        OxygenCoef: number = -1.0\n        CanStrafe: boolean = true\n        EnterToolStore: boolean = true\n        ShowHealthBar: boolean = true\n    }\n\n    RockMonster = new class RockMonsterStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 0.8\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 22.0\n        AlertRadius: number = 60.0\n        HealthDecayRate: number = 0.6 // Reduce health by 'n' every second.\n        PickSphere: number = 22.0\n        RepairValue: number = -10.0\n        CanScare: boolean = true\n        RestPercent: number = 20.0\n        CarryMinHealth: number = 15.0\n        PainThreshold: number = 20.0\n        StampRadius: number = 80.0\n        AttackRadius: number = 160.0\n        CanSteal: boolean = true\n        CrossLand: boolean = true\n        RubbleCoef: number = 1.5\n        GrabMinifigure: boolean = true\n        RouteAvoidance: boolean = true\n        BumpDamage: boolean = true\n        AttackPaths: boolean = true\n        SplitOnZeroHealth: boolean = true\n        CanBeHitByFence: boolean = true\n        Capacity: number = 6 // How many crystals it can eat\n        PathCoef: number = 0.5\n        // Statistics about the weapons\n        CanBeShotAt: boolean = true // Can this monster be shot at by lego men\n        CanFreeze: boolean = true // Can this object be frozen\n        FreezerTime: number = 25.0 // Time this object is frozen for\n        FreezerDamage: number = 5.0 // Damage that freezing causes\n        CanLaser: boolean = true // Can this object be lasered\n        LaserDamage: number = 110.0 // Damage sustained by a laser\n        CanPush: boolean = true // Can this object be pusher'ed\n        PusherDist: number = 20.0 // Distance the object is pushed 40=1 block\n        PusherDamage: number = 2.0 // Damage that the pusher gun causes\n        WakeRadius: number = 25.0\n        ScaredByBigBangs: boolean = true\n        RemoveReinforcement: boolean = true\n        ShowHealthBar: boolean = true\n    }\n\n    SmallSpider = new class SmallSpiderStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number[] = [2.0]\n        TrackDist: number = 10.0\n        CollRadius: number = 0.0\n        CollHeight: number = 0.0\n        PickSphere: number = 6.0\n        AlertRadius: number = 40.0\n        RandomMove: boolean = true\n        RandomEnterWall: boolean = true\n        CauseSlip: boolean = true\n        CrossLand: boolean = true\n        RubbleCoef: number = 0.2\n        DontShowDamage: boolean = true\n        DontShowOnRadar: boolean = true\n        ScaredByBigBangs: boolean = true\n    }\n\n    Bat = new class BatStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number[] = [1.0]\n        TrackDist: number = 10.0\n        CollRadius: number = 10.0\n        AlertRadius: number = 10.0 // Alert radius (causes attack mode)\n        RandomMove: boolean = true // Random movement\n        randomMoveTime: number = 10\n        CanScare: boolean = true // Scare away the player\n        ScaredByBigBangs: boolean = true\n        // Flock parameters.\n        Flocks: boolean = true // Set this to create a flock for this object.\n        FlocksDebug: boolean = false // If this is set the actual lego objects animation is displayed at the \"lego\" position.\n        FlocksSmooth: boolean = true // Smooths out the orientation of the flocks elements.\n        FlocksSize: number = 8 // Number of the given item in the flock.  (Default 5)\n        FlocksTurn: number = 0.6 // Turning speed of the bat. (0.6 default)\n        FlocksSpeed: number = 1.5 // Velocity of the flock. (2.0 default)\n        FlocksTightness: number = 0.8 // Tightness of the flock. (2.0 default)\n        FlocksGoalUpdate: number = 2.0 // How often the flocks goal is updated (25 per second).  (2.0 default)\n        FlocksRandomness: number = 6.0 // Randomness of goals. (2.0 default)\n        FlocksHeight: number = 22.0 // Height above the ground of the flock elements.  (30.0 default)\n        CrossLand: boolean = true\n        CrossWater: boolean = true\n        CrossLava: boolean = true\n        DontShowDamage: boolean = true\n    }\n\n    TinyRM = new class TinyRMStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 1.2\n        TrackDist: number = 10.0\n        CollRadius: number = 0.0\n        CollHeight: number = 5.0\n        PickSphere: number = 6.0\n        AlertRadius: number = 40.0\n        CrossLand: boolean = true\n        RubbleCoef: number = 1.5\n        DontShowDamage: boolean = true\n        DontShowOnRadar: boolean = true\n        ScaredByPlayer: boolean = true\n        ScaredByBigBangs: boolean = true\n    }\n\n    TinyIM = new class TinyIMStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 1.2\n        TrackDist: number = 10.0\n        CollRadius: number = 0.0\n        CollHeight: number = 5.0\n        PickSphere: number = 6.0\n        AlertRadius: number = 40.0\n        CrossLand: boolean = true\n        RubbleCoef: number = 1.5\n        DontShowDamage: boolean = true\n        DontShowOnRadar: boolean = true\n        ScaredByPlayer: boolean = true\n        ScaredByBigBangs: boolean = true\n    }\n\n    Slug = new class SlugStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 0.3\n        TrackDist: number = 10.0\n        CollRadius: number = 3.0\n        CollHeight: number = 7.0\n        PickSphere: number = 12.0\n        AlertRadius: number = 40.0\n        CrossLand: boolean = true\n        RubbleCoef: number = 0.3\n        UseHoles: boolean = true\n        DrainPower: boolean = true\n        AttackRadius: number = 280.0\n        PainThreshold: number = 50.0\n        CanBeShotAt: boolean = true\n        CanLaser: boolean = true\n        LaserDamage: number = 5.0\n        CanPush: boolean = true // Can this object be pusher'ed\n        PusherDist: number = 60.0 // Distance the object is pushed\n        PusherDamage: number = 5.0 // Damage that the pusher gun causes\n        ShowHealthBar: boolean = true\n        ScaredByBigBangs: boolean = true\n    }\n\n    LavaMonster = new class LavaMonsterStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 0.8\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 22.0\n        AlertRadius: number = 60.0\n        HealthDecayRate: number = 0.6 // Reduce health by 'n' every second.\n        PickSphere: number = 22.0\n        RepairValue: number = -10.0\n        CanScare: boolean = true\n        RestPercent: number = 20.0\n        CarryMinHealth: number = 15.0\n        PainThreshold: number = 20.0\n        StampRadius: number = 80.0\n        AttackRadius: number = 160.0\n        CanSteal: boolean = true\n        CrossLand: boolean = true\n        RubbleCoef: number = 1.5\n        GrabMinifigure: boolean = true\n        Capacity: number = 7 // How many crystals it can eat\n        RouteAvoidance: boolean = true\n        BumpDamage: boolean = true\n        AttackPaths: boolean = true\n        SplitOnZeroHealth: boolean = true\n        CanBeHitByFence: boolean = true\n        PathCoef: number = 0.5\n        CrossLava: boolean = true\n        // Statistics about the weapons\n        CanBeShotAt: boolean = true // Can this monster be shot at by lego men\n        CanFreeze: boolean = true // Can this object be frozen\n        FreezerTime: number = 75.0 // Time this object is frozen for\n        FreezerDamage: number = 40.0 // Damage that freezing causes\n        CanLaser: boolean = true // Can this object be lasered\n        LaserDamage: number = 1.0 // Damage sustained by a laser\n        CanPush: boolean = true // Can this object be pusher'ed\n        PusherDist: number = 60.0 // Distance the object is pushed\n        PusherDamage: number = 5.0 // Damage that the pusher gun causes\n        WakeRadius: number = 25.0\n        ScaredByBigBangs: boolean = true\n        RemoveReinforcement: boolean = true\n        ShowHealthBar: boolean = true\n    }\n\n    IceMonster = new class IceMonsterStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 0.8\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 22.0\n        AlertRadius: number = 60.0\n        HealthDecayRate: number = 0.6 // Reduce health by 'n' every second.\n        PickSphere: number = 22.0\n        RepairValue: number = -10.0\n        CanScare: boolean = true\n        RestPercent: number = 20.0\n        CarryMinHealth: number = 15.0\n        PainThreshold: number = 20.0\n        StampRadius: number = 80.0\n        AttackRadius: number = 120.0\n        CanSteal: boolean = true\n        CrossLand: boolean = true\n        RubbleCoef: number = 1.5\n        GrabMinifigure: boolean = true\n        Capacity: number = 5 // How many crystals it can eat\n        RouteAvoidance: boolean = true\n        BumpDamage: boolean = true\n        AttackPaths: boolean = true\n        SplitOnZeroHealth: boolean = true\n        CanBeHitByFence: boolean = true\n        PathCoef: number = 0.5\n        // Statistics about the weapons\n        CanBeShotAt: boolean = true // Can this monster be shot at by lego men\n        CanFreeze: boolean = false // Can this object be frozen\n        FreezerTime: number = 0.0 // Time this object is frozen for\n        FreezerDamage: number = 0.0 // Damage that freezing causes\n        CanLaser: boolean = true // Can this object be lasered\n        LaserDamage: number = 110.0 // Damage sustained by a laser\n        CanPush: boolean = true // Can this object be pusher'ed\n        PusherDist: number = 60.0 // Distance the object is pushed\n        PusherDamage: number = 2.0 // Damage that the pusher gun causes\n        WakeRadius: number = 25.0\n        ScaredByBigBangs: boolean = true\n        RemoveReinforcement: boolean = true\n        ShowHealthBar: boolean = true\n    }\n\n    Hoverboard = new class HoverboardStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No drill or carry)\n        Levels: number = 8\n        RouteSpeed: number[] = [3.0, 3.0, 5.0, 5.0, 3.0, 3.0, 5.0, 5.0]\n        SurveyRadius: number[] = [0, 0, 0, 0, 4, 4, 4, 4]\n        TrackDist: number = 50.0\n        CollRadius: number = 8.0\n        CollHeight: number = 12.0\n        PickSphere: number = 16.0\n        CanBeDriven: boolean = true\n        CrossLand: boolean = true\n        UseSmallTeleporter: boolean = true\n        CanStrafe: boolean = true\n        CostCrystal: number = 1\n        UpgradeCostOre: number[] = [0, 5, 10, 0]\n        UpgradeCostStuds: number[] = [0, 1, 2, 0]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_SmallEngine'\n    }\n\n    SmallHeli = new class SmallHeliStats extends BaseConfig {\n        Levels: number = 1\n        RouteSpeed: number = 2.50\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 12.0\n        PickSphere: number = 20.0\n        CanBeDriven: boolean = true\n        CrossLand: boolean = true\n        CrossWater: boolean = true\n        CrossLava: boolean = true\n        UseSmallTeleporter: boolean = true\n        CanStrafe: boolean = true\n        CostCrystal: number = 3\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_HeliEngine'\n    }\n\n    Smallmlp = new class SmallmlpStats extends BaseConfig {\n        Levels: number = 4\n        RouteSpeed: number[] = [0.50, 0.50, 0.50, 0.50]\n        TrackDist: number = 50.0\n        CollRadius: number = 12.0\n        CollHeight: number = 22.0\n        PickSphere: number = 26.0\n        CanBeDriven: boolean = true\n        CrossLand: boolean = true\n        UseSmallTeleporter: boolean = true\n        Tracker: boolean = true\n        CanDoubleSelect: boolean = true\n        CostCrystal: number = 3\n        UpgradeCostOre: number[] = [0, 0, 0, 10]\n        UpgradeCostStuds: number[] = [0, 0, 0, 2]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_MediumEngine'\n    }\n\n    SmallCat = new class SmallCatStats extends BaseConfig {\n        Levels: number = 3\n        RouteSpeed: number[] = [2.0, 3.0, 4.0]\n        TrackDist: number = 50.0\n        CollRadius: number = 12.0\n        CollHeight: number = 12.0\n        PickSphere: number = 26.0\n        CrossWater: boolean = true\n        CanBeDriven: boolean = true\n        UseWaterTeleporter: boolean = true\n        CostCrystal: number = 2\n        MaxCarry: number[] = [1, 1, 1]\n        GetInAtLand: boolean = true\n        GetOutAtLand: boolean = true\n        TakeCarryingDrivers: boolean = true\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_Catamaran'\n    }\n\n    SmallDigger = new class SmallDiggerStats extends BaseConfig {\n        Levels: number = 8\n        RouteSpeed: number[] = [2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 4.0, 4.0]\n        SoilDrillTime: number[] = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]\n        LooseDrillTime: number[] = [2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0]\n        MedDrillTime: number[] = [4.0, 2.0, 4.0, 2.0, 4.0, 2.0, 4.0, 2.0]\n        HardDrillTime: number[] = [180.0, 150.0, 180.0, 150.0, 180.0, 150.0, 180.0, 150.0]\n        SeamDrillTime: number[] = [8.0, 4.0, 8.0, 4.0, 8.0, 4.0, 8.0, 4.0]\n        MaxCarry: number[] = [0, 0, 0, 0, 0, 0, 0, 0]\n        SurveyRadius: number[] = [0, 0, 0, 0, 4, 4, 4, 4]\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 12.0\n        PickSphere: number = 20.0\n        CanBeDriven: boolean = true\n        CrossLand: boolean = true\n        RouteAvoidance: boolean = true\n        UseSmallTeleporter: boolean = true\n        VehicleCanBeCarried: boolean = true\n        CostCrystal: number = 1\n        UpgradeCostOre: number[] = [0, 5, 10, 10]\n        UpgradeCostStuds: number[] = [0, 1, 2, 2]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_SmallEngine'\n    }\n\n    SmallTruck = new class SmallTruckStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No drill)\n        Levels: number = 16\n        RouteSpeed: number[] = [2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0]\n        MaxCarry: number[] = [3, 3, 3, 3, 3, 3, 3, 3, 6, 6, 6, 6, 6, 6, 6, 6]\n        CarryStart: number[] = [0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3]\n        SurveyRadius: number[] = [0, 0, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0, 4, 4, 4, 4]\n        TrackDist: number = 50.0\n        CollRadius: number = 10.0\n        CollHeight: number = 12.0\n        PickSphere: number = 20.0\n        CanBeDriven: boolean = true\n        CrossLand: boolean = true\n        UseSmallTeleporter: boolean = true\n        VehicleCanBeCarried: boolean = true\n        CostCrystal: number = 2\n        EnterToolStore: boolean = true\n        UpgradeCostOre: number[] = [5, 5, 10, 0]\n        UpgradeCostStuds: number[] = [1, 1, 2, 0]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_SmallEngine'\n    }\n\n    Bulldozer = new class BulldozerStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No drill)\n        Levels: number = 16\n        RouteSpeed: number[] = [0.5, 0.5, 0.8, 0.8, 0.5, 0.5, 0.8, 0.8, 0.5, 0.5, 0.8, 0.8, 0.5, 0.5, 0.8, 0.8]\n        MaxCarry: number[] = [0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2]\n        SurveyRadius: number[] = [0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 5, 5, 5, 5]\n        TrackDist: number = 80.0\n        CollRadius: number = 18.0\n        CollHeight: number = 26.0\n        PickSphere: number = 40.0\n        CrossLand: boolean = true\n        CanClearRubble: boolean = true\n        UseBigTeleporter: boolean = true\n        CanBeDriven: boolean = true\n        CostCrystal: number = 4\n        InvisibleDriver: boolean = true\n        UpgradeCostOre: number[] = [5, 5, 20, 0]\n        UpgradeCostStuds: number[] = [1, 1, 4, 0]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_MediumEngine'\n    }\n\n    WalkerDigger = new class WalkerDiggerStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No carry)\n        Levels: number = 8\n        RouteSpeed: number[] = [0.50, 0.50, 0.80, 0.80, 0.50, 0.50, 0.80, 0.80]\n        SoilDrillTime: number[] = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]\n        LooseDrillTime: number[] = [0.80, 0.40, 0.80, 0.40, 0.80, 0.40, 0.80, 0.40]\n        MedDrillTime: number[] = [2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0]\n        HardDrillTime: number[] = [180.0, 150.0, 180.0, 150.0, 180.0, 150.0, 180.0, 150.0]\n        SeamDrillTime: number[] = [4.0, 2.0, 4.0, 2.0, 4.0, 2.0, 4.0, 2.0]\n        SurveyRadius: number[] = [0, 0, 0, 0, 5, 5, 5, 5]\n        TrackDist: number = 80.0\n        CollRadius: number = 15.0\n        CollHeight: number = 33.0\n        PickSphere: number = 35.0\n        CrossLand: boolean = true\n        UseBigTeleporter: boolean = true\n        CostCrystal: number = 3\n        CanBeDriven: boolean = true\n        InvisibleDriver: boolean = true\n        CanStrafe: boolean = true\n        DrillSound: string = 'DrillSFX_Grinder'\n        DrillFadeSound: string = 'DrillSFX_GrinderFade'\n        UpgradeCostOre: number[] = [0, 5, 20, 20]\n        UpgradeCostStuds: number[] = [0, 1, 4, 4]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_MediumEngine'\n    }\n\n    LargeDigger = new class LargeDiggerStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No carry or scan)\n        Levels: number = 4\n        RouteSpeed: number[] = [0.30, 0.30, 0.60, 0.60]\n        SoilDrillTime: number[] = [1.0, 1.0, 1.0, 1.0]\n        LooseDrillTime: number[] = [0.40, 0.20, 0.40, 0.20]\n        MedDrillTime: number[] = [0.80, 0.40, 0.80, 0.40]\n        HardDrillTime: number[] = [1.0, 0.50, 1.0, 0.50]\n        SeamDrillTime: number[] = [1.0, 0.50, 1.0, 0.50]\n        TrackDist: number = 80.0\n        CollRadius: number = 22.0\n        CollHeight: number = 30.0\n        PickSphere: number = 50.0\n        CrossLand: boolean = true\n        UseBigTeleporter: boolean = true\n        Tracker: boolean = true\n        CanDoubleSelect: boolean = true\n        CanBeDriven: boolean = true\n        CostCrystal: number = 5\n        InvisibleDriver: boolean = true\n        DrillSound: string = 'DrillSFX_Grinder'\n        DrillFadeSound: string = 'DrillSFX_GrinderFade'\n        UpgradeCostOre: number[] = [0, 0, 15, 20]\n        UpgradeCostStuds: number[] = [0, 0, 3, 4]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_LargeEngine'\n    }\n\n    LargeCat = new class LargeCatStats extends BaseConfig { // [Carry][Scan][Speed][Drill] (No carry) (Drill???)\n        Levels: number = 1\n        RouteSpeed: number = 1.50\n        SurveyRadius: number = 0\n        TrackDist: number = 80.0\n        CollRadius: number = 22.0\n        CollHeight: number = 25.0\n        PickSphere: number = 50.0\n        CanBeDriven: boolean = true\n        CrossWater: boolean = true\n        UseWaterTeleporter: boolean = true\n        ClassAsLarge: boolean = true\n        CarryVehicles: boolean = true\n        CostCrystal: number = 4\n        EngineSound: string = 'SND_Catamaran'\n        ShowHealthBar: boolean = true\n    }\n\n    LargeHeli = new class LargeHeliStats extends BaseConfig {\n        Levels: number = 3\n        RouteSpeed: number[] = [0.30, 0.40, 0.50]\n        TrackDist: number = 80.0\n        CollRadius: number = 0.0\n        CollHeight: number = 0.0\n        PickSphere: number = 20.0\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_HeliEngine'\n    }\n\n    LargeMLP = new class LargeMLPStats extends BaseConfig { // [Carry][Scan][Speed][Drill]    (No carry or speed) (Doesn't have drills, just lasers)\n        Levels: number = 8\n        RouteSpeed: number[] = [0.40, 0.40, 0.40, 0.40, 0.40, 0.40, 0.40, 0.40]\n        SurveyRadius: number[] = [0, 0, 0, 0, 5, 5, 5, 5]\n        TrackDist: number = 80.0\n        CollRadius: number = 20.0\n        CollHeight: number = 24.0\n        PickSphere: number = 47.0\n        CrossLand: boolean = true\n        UseBigTeleporter: boolean = true\n        Tracker: boolean = true\n        CanDoubleSelect: boolean = true\n        CostCrystal: number = 4\n        CanBeDriven: boolean = true\n        InvisibleDriver: boolean = true\n        UpgradeCostOre: number[] = [0, 5, 0, 25]\n        UpgradeCostStuds: number[] = [0, 1, 0, 5]\n        ShowHealthBar: boolean = true\n        EngineSound: string = 'SND_LargeEngine'\n    }\n\n    Barracks = new class BarracksStats extends BuildingEntityStats {\n        Levels: number = 3\n        TrackDist: number = 50.0\n        CollHeight: number = 23.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 15\n        CostRefinedOre: number = 3\n        CostCrystal: number = 3\n        SnaxULike: boolean = true\n        TrainDriver: boolean[] = [true, true, true]\n        CrystalDrain: number[] = [1, 1, 1]\n        DamageCausesCallToArms: boolean = true\n        OxygenCoef: number = 10.0\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    Powerstation = new class PowerstationStats extends BuildingEntityStats {\n        Levels: number = 2\n        TrackDist: number = 80.0\n        ProcessCrystal: boolean = true\n        CollHeight: number = 31.0\n        CollRadius: number = 15.0\n        PickSphere: number = 32.0\n        CostOre: number = 12\n        CostRefinedOre: number = 3\n        CostCrystal: number = 2\n        PowerBuilding: boolean = true\n        DamageCausesCallToArms: boolean = true\n        EngineSound: string = 'SND_PowerBuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    OreRefinery = new class OreRefineryStats extends BuildingEntityStats {\n        Levels: number = 4\n        TrackDist: number = 60.0\n        ProcessOre: boolean = true\n        CollHeight: number = 16.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 20\n        CostRefinedOre: number = 4\n        CostCrystal: number = 3\n        CrystalDrain: number[] = [1, 1, 1, 1]\n        DamageCausesCallToArms: boolean = true\n        MaxCarry: number[] = [5, 4, 3, 2]\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    TeleportPad = new class TeleportPadStats extends BuildingEntityStats {\n        Levels: number = 3\n        TrackDist: number = 60.0\n        SmallTeleporter: boolean = true\n        ManTeleporter: boolean = true\n        CollHeight: number = 20.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 8\n        CostRefinedOre: number = 2\n        CrystalDrain: number[] = [1, 1, 1]\n        DamageCausesCallToArms: boolean = true\n        TrainPilot: boolean[] = [true, true, true]\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    TeleportBIG = new class TeleportBIGStats extends BuildingEntityStats {\n        Levels: number = 2\n        TrackDist: number = 50.0\n        BigTeleporter: boolean = true\n        CollHeight: number = 17.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 20\n        CostRefinedOre: number = 4\n        CostCrystal: number = 2\n        CrystalDrain: number[] = [1, 1]\n        DamageCausesCallToArms: boolean = true\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    Docks = new class DocksStats extends BuildingEntityStats {\n        Levels: number = 1\n        TrackDist: number = 60.0\n        CollHeight: number = 20.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 8\n        CostRefinedOre: number = 2\n        CostCrystal: number = 1\n        WaterEntrances: number = 1\n        WaterTeleporter: boolean = true\n        CrystalDrain: number = 1\n        DamageCausesCallToArms: boolean = true\n        TrainSailor: boolean = true\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    Toolstation = new class ToolstationStats extends BuildingEntityStats {\n        Levels: number = 3\n        TrackDist: number = 50.0\n        ManTeleporter: boolean = true\n        CollHeight: number = 16.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        ToolStore: boolean = true\n        StoreObjects: boolean = true\n        SelfPowered: boolean = true\n        DamageCausesCallToArms: boolean = true\n        TrainDynamite: boolean[] = [false, false, true]\n        FunctionCoef: number[] = [1.0, 1.0, 1.0] // Function here is how long it takes to upgrade a minfigure\n        ShowHealthBar: boolean = true\n    }\n\n    GunStation = new class GunStationStats extends BuildingEntityStats {\n        Levels: number = 2\n        TrackDist: number = 60.0\n        CollHeight: number = 33.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 15\n        CostRefinedOre: number = 3\n        CostCrystal: number = 1\n        Tracker: boolean = true\n        CanDoubleSelect: boolean = true\n        CrystalDrain: number[] = [1, 1]\n        DamageCausesCallToArms: boolean = true\n        FunctionCoef: number[] = [1.0, 0.5] // How much of a crystal it drains every time it fires...\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    Geodome = new class GeodomeStats extends BuildingEntityStats {\n        Levels: number = 3\n        TrackDist: number = 50.0\n        CollHeight: number = 20.0\n        CollRadius: number = 15.0\n        PickSphere: number = 30.0\n        CostOre: number = 15\n        CostRefinedOre: number = 3\n        CostCrystal: number = 3\n        SurveyRadius: number[] = [6, 8, 12]\n        CrystalDrain: number[] = [1, 1, 1]\n        DamageCausesCallToArms: boolean = true\n        TrainScanner: boolean[] = [true, true, true]\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    Upgrade = new class UpgradeStats extends BuildingEntityStats {\n        Levels: number = 2\n        TrackDist: number = 80.0\n        CollHeight: number = 40.0\n        CollRadius: number = 15.0\n        PickSphere: number = 32.0\n        CostOre: number = 20\n        CostRefinedOre: number = 4\n        CostCrystal: number = 3\n        UpgradeBuilding: boolean = true\n        CrystalDrain: number[] = [1, 1]\n        DamageCausesCallToArms: boolean = true\n        FunctionCoef: number[] = [0.8, 1.6] // Function is speed of upgrade animation.\n        TrainRepair: boolean[] = [true, true]\n        EngineSound: string = 'SND_BuildingHum'\n        ShowHealthBar: boolean = true\n    }\n\n    PowerCrystal = new class PowerCrystalStats extends BaseConfig {\n        Levels: number = 1\n        TrackDist: number = 20.0\n        CollHeight: number = 2.0\n        PickSphere: number = 6.0\n    }\n\n    ProcessedOre = new class ProcessedOreStats extends BaseConfig {\n        Levels: number = 1\n        TrackDist: number = 20.0\n        CollHeight: number = 2.0\n        PickSphere: number = 8.0\n    }\n\n    Ore = new class OreStats extends BaseConfig {\n        Levels: number = 1\n        TrackDist: number = 20.0\n        CollHeight: number = 2.0\n        PickSphere: number = 6.0\n    }\n\n    Boulder = new class BoulderStats extends BaseConfig {\n        Levels: number = 1\n        CollRadius: number = 2.0\n    }\n\n    Pusher = new class PusherStats extends BaseConfig {\n        Levels: number = 1\n        CollRadius: number = 1.0\n    }\n\n    Freezer = new class FreezerStats extends BaseConfig {\n        Levels: number = 1\n        CollRadius: number = 1.0\n    }\n\n    LaserShot = new class LaserShotStats extends BaseConfig {\n        Levels: number = 1\n        ColRadius: number = 1.0\n    }\n\n    ElectricFence = new class ElectricFenceStats extends BaseConfig {\n        Levels: number = 1\n        TrackDist: number = 50.0\n        CollRadius: number = 5.0\n        CollHeight: number = 18.0\n        PickSphere: number = 20.0\n        DamageCausesCallToArms: boolean = true\n    }\n\n    Path = new class PathStats extends BaseConfig {\n        Levels: number = 1\n        CostOre: number = 2\n        CostRefinedOre: number = 1\n    }\n\n    constructor(cfgObj: any) {\n        super()\n        BaseConfig.setFromCfg(this, cfgObj)\n    }\n\n    assignValue(objKey, lCfgKeyName, cfgValue): boolean {\n        if (objKey.toLowerCase() === lCfgKeyName) {\n            BaseConfig.setFromCfg(this[objKey], cfgValue)\n            return true\n        }\n    }\n\n}\n\n","import { GameStatsCfg } from '../../cfg/GameStatsCfg'\nimport { WorkerMessageType } from './WorkerMessageType'\n\nexport class WadWorkerMessage {\n\n    type: WorkerMessageType = null\n    text?: string\n    cfg?: any\n    stats?: any\n    totalResources?: number\n    assetNames?: string[]\n    assetObj?: any\n    sfxKeys?: string[]\n    loadingTimeSeconds?: string\n\n    constructor(type: WorkerMessageType) {\n        this.type = type\n    }\n\n    static createTextMessage(msg: string): WadWorkerMessage {\n        return {type: WorkerMessageType.MSG, text: msg}\n    }\n\n    static createCfgLoaded(cfg: any, totalResources: number): WadWorkerMessage {\n        return {\n            type: WorkerMessageType.CFG,\n            cfg: cfg,\n            stats: new GameStatsCfg(cfg['Stats']),\n            totalResources: totalResources,\n        }\n    }\n\n    static createAssetLoaded(assetIndex: number, assetNames: string[], assetObj: any, sfxKeys: string[]): WadWorkerMessage {\n        return {type: WorkerMessageType.ASSET, assetNames: assetNames, assetObj: assetObj, sfxKeys: sfxKeys}\n    }\n\n    static createLoadDone(totalResources: number, loadingTimeSeconds: string): WadWorkerMessage {\n        return {type: WorkerMessageType.DONE, totalResources: totalResources, loadingTimeSeconds: loadingTimeSeconds}\n    }\n\n}\n","import { InitLoadingMessage } from './InitLoadingMessage'\nimport { WadLoader } from './WadLoader'\nimport { WadWorkerMessage } from './WadWorkerMessage'\nimport { WorkerMessageType } from './WorkerMessageType'\n\nconst worker: Worker = self as any\n\nfunction postMessage(assetMessage: WadWorkerMessage) {\n    worker.postMessage(assetMessage)\n}\n\nworker.addEventListener('message', (event) => {\n    const wadLoader = new WadLoader()\n    // set callbacks on wadLoader\n    wadLoader.onMessage = (text: string) => postMessage(WadWorkerMessage.createTextMessage(text))\n    wadLoader.onInitialLoad = (totalResources: number, cfg: any) => postMessage(WadWorkerMessage.createCfgLoaded(cfg, totalResources))\n    wadLoader.onAssetLoaded = (assetIndex: number, assetNames: string[], assetObj: any, sfxKeys: string[]) => {\n        postMessage(WadWorkerMessage.createAssetLoaded(assetIndex, assetNames, assetObj, sfxKeys))\n    }\n    wadLoader.onLoadDone = (totalResources: number, loadingTimeSeconds: string) => {\n        postMessage(WadWorkerMessage.createLoadDone(totalResources, loadingTimeSeconds))\n    }\n    // start loading\n    const msg = event.data as InitLoadingMessage\n    if (msg) {\n        wadLoader.loadWadFiles(msg.wad0FileUrl, msg.wad1FileUrl)\n    } else {\n        wadLoader.startWithCachedFiles(() => postMessage(new WadWorkerMessage(WorkerMessageType.CACHE_MISS)))\n    }\n})\n"],"sourceRoot":""}
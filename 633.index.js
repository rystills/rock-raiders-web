(()=>{"use strict";var t,e,i={800:(t,e,i)=>{var s,h,a;i.d(e,{T:()=>s,iW:()=>h,Zf:()=>a}),function(t){t[t.MAIN=0]="MAIN",t[t.MIDDLE=1]="MIDDLE",t[t.SECONDARY=2]="SECONDARY"}(s||(s={})),function(t){t[t.MOVE=0]="MOVE",t[t.DOWN=1]="DOWN",t[t.UP=2]="UP"}(h||(h={})),function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(a||(a={}))},848:(t,e,i)=>{i.d(e,{Sl:()=>s,CM:()=>h,Du:()=>a,DG:()=>r,OK:()=>n});const s=!1,h=3,a=640,r=480,n=30},633:(t,e,i)=>{var s=i(800),h=i(211),a=i(670),r=i(796);class n{constructor(t){this.x=0,this.y=0,this.w=0,this.h=0,[this.x,this.y,this.w,this.h]=t}}var o=i(935);class l extends o.l{constructor(t){super(),this.image=null,this.titleWindow=null,this.textWindow=null,this.okWindow=null,this.cancelWindow=null,this.contrastOverlay=null,o.l.setFromCfg(this,t)}parseValue(t,e){return t.endsWith("window")?new n(e):super.parseValue(t,e)}}var g=i(234);class c extends g.l{constructor(){super([]),this.titleFont=r.x.getBitmapFont("Interface/Fonts/MbriefFont2.bmp"),this.title=r.x.cfg("Main","MissionBriefingText");const t=new l(r.x.cfg("Dialog"));this.titleWindow=t.titleWindow,this.textFont=r.x.getBitmapFont("Interface/Fonts/MbriefFont.bmp"),this.textWindow=t.textWindow,this.textWindow.y-=10,this.nextButtonCfg={buttonType:"Next briefing paragraph",relX:394,relY:214,normalFile:r.x.cfg("Main","NextButton640x480")},this.backButtonCfg={buttonType:"Previous briefing paragraph",relX:54,relY:214,normalFile:r.x.cfg("Main","BackArrow")}}}class m extends a.s{constructor(t){super(t),this.cfg=null,this.imgTitle=null,this.titleRelX=0,this.titleRelY=0,this.btnNext=null,this.btnBack=null,this.imgBack=null,this.imgParagraphList=[],this.paragraph=0,this.imgParagraph=null,this.onSetSpaceToContinue=t=>console.log("Message: press space to continue = "+t),this.cfg=new c,this.imgTitle=this.cfg.titleFont.createTextImage(this.cfg.title),this.titleRelX=this.cfg.titleWindow.x+(this.cfg.titleWindow.w-this.imgTitle.width)/2,this.titleRelY=this.cfg.titleWindow.y,this.btnNext=this.addChild(new h.z(this,this.cfg.nextButtonCfg)),this.btnNext.onClick=()=>this.nextParagraph(),this.btnBack=this.addChild(new h.z(this,this.cfg.backButtonCfg)),this.btnBack.onClick=()=>this.prevParagraph(),this.hidden=!0}reset(){super.reset(),this.hidden=!0,this.setParagraph(0)}setup(t,e){this.imgBack=r.x.getImageOrNull(e.filename),this.xIn=e.x,this.yIn=e.y,this.width=this.imgBack.width,this.height=this.imgBack.height,this.updatePosition(),this.imgParagraphList=t.split("\\a").map((t=>this.cfg.textFont.createTextImage(t,this.cfg.textWindow.w,!1)))}setParagraph(t){if(!(t<0)){if(t>this.imgParagraphList.length-1)return this.hide(),void this.notifyRedraw();this.paragraph=t,this.imgParagraph=this.imgParagraphList[this.paragraph],this.btnNext.hidden=this.paragraph>=this.imgParagraphList.length-1,this.btnBack.hidden=this.paragraph<1,this.notifyRedraw()}}nextParagraph(){this.setParagraph(this.paragraph+1)}prevParagraph(){this.setParagraph(this.paragraph-1)}show(){super.show(),this.setParagraph(0),this.btnNext.hidden=this.paragraph>=this.imgParagraphList.length-1,this.btnBack.hidden=this.paragraph<1,this.onSetSpaceToContinue(!0)}hide(){super.hide(),this.onSetSpaceToContinue(!1)}onRedraw(t){this.hidden||(this.imgBack&&t.drawImage(this.imgBack,this.x,this.y),this.imgTitle&&t.drawImage(this.imgTitle,this.x+this.titleRelX,this.y+this.titleRelY),this.imgParagraph&&t.drawImage(this.imgParagraph,this.x+this.cfg.textWindow.x,this.y+this.cfg.textWindow.y),super.onRedraw(t))}}var d=i(848),p=i(360);class u extends p.H{constructor(t,e){super(t),this.labelX=0,this.state=!1,this.relX=e.x,this.relY=e.y,this.labelX=e.width,this.imgTextNormal=t.loFont.createTextImage(e.description),this.imgTextHover=t.hiFont.createTextImage(e.description),this.imgLabelOffNormal=t.loFont.createTextImage(e.labelOff),this.imgLabelOffHover=t.hiFont.createTextImage(e.labelOff),this.imgLabelOnNormal=t.loFont.createTextImage(e.labelOn),this.imgLabelOnHover=t.hiFont.createTextImage(e.labelOn),this.width=e.width+Math.max(this.imgLabelOnHover.width,this.imgLabelOffHover.width),this.height=this.imgTextNormal.height}onClick(){this.state=!this.state,console.log("TODO: cycle item clicked; state: "+this.state)}checkHover(t,e){const i=super.checkHover(t,e);return i&&this.notifyRedraw(),i}checkClick(t,e){const i=super.checkClick(t,e);return i&&this.notifyRedraw(),i}checkRelease(t,e){const i=super.checkRelease(t,e);return i&&this.notifyRedraw(),i}release(){const t=super.release();return t&&this.notifyRedraw(),t}onRedraw(t){if(this.hidden)return;let e=this.imgTextNormal,i=this.state?this.imgLabelOnNormal:this.imgLabelOffNormal;this.hover&&(e=this.imgTextHover,i=this.state?this.imgLabelOnHover:this.imgLabelOffHover),t.drawImage(e,this.x,this.y),t.drawImage(i,this.x+this.labelX,this.y),super.onRedraw(t)}}class w extends p.H{constructor(t,e,i){super(t),this.target=e.target,this.loImg=t.loFont.createTextImage(e.label),this.hiImg=t.hiFont.createTextImage(e.label),this.width=this.loImg.width,this.height=this.loImg.height,this.relX=i?-t.relX+(t.menuImage.width-this.width)/2:e.x,this.relY=e.y}checkHover(t,e){const i=super.checkHover(t,e);return i&&this.notifyRedraw(),i}checkClick(t,e){const i=super.checkClick(t,e);return i&&this.notifyRedraw(),i}checkRelease(t,e){const i=super.checkRelease(t,e);return i&&this.notifyRedraw(),i}release(){const t=super.release();return t&&this.notifyRedraw(),t}onRedraw(t){this.hidden||(this.hover?t.drawImage(this.hiImg,this.x,this.y):t.drawImage(this.loImg,this.x,this.y),super.onRedraw(t))}}var f=i(930);class x extends p.H{constructor(t,e){super(t),this.sliderX=0,this.min=0,this.max=1,this.value=0,this.onValueChanged=t=>console.log("value changed to: "+t),this.relX=e.x,this.relY=e.y,this.sliderX=e.width,this.imgLeft=r.x.getImage(e.imgLeft),this.imgNormal=r.x.getImage(e.imgOff),this.imgHover=r.x.getImage(e.imgOn),this.imgRight=r.x.getImage(e.imgRight);const i=this.addChild(new h.z(this,new f.p));i.imgNormal=r.x.getImage(e.btnLeftNormal),i.imgHover=r.x.getImage(e.btnLeftHover),i.relX=this.sliderX-this.imgLeft.width-i.imgHover.width,i.width=i.imgHover.width,i.height=i.imgHover.height,i.updatePosition(),i.onClick=()=>{this.value>this.min&&(this.value--,this.onValueChanged(this.value))};const s=this.addChild(new h.z(this,new f.p));s.imgNormal=r.x.getImage(e.btnRightNormal),s.imgHover=r.x.getImage(e.btnRightHover),s.relX=this.sliderX+this.imgNormal.width+2*this.imgRight.width,s.width=s.imgHover.width,s.height=s.imgHover.height,s.updatePosition(),s.onClick=()=>{this.value<this.max&&(this.value++,this.onValueChanged(this.value))},this.width=e.width+i.imgHover.width+this.imgLeft.width+this.imgNormal.width+2*this.imgRight.width+s.imgHover.width,this.min=e.min,this.max=e.max||1,this.value=this.min,this.imgTextNormal=t.loFont.createTextImage(e.description),this.imgTextHover=t.hiFont.createTextImage(e.description),this.height=this.imgTextNormal.height}checkHover(t,e){const i=super.checkHover(t,e);return i&&this.notifyRedraw(),i}onRedraw(t){if(this.hidden)return;let e=this.imgTextNormal;this.hover&&(e=this.imgTextHover),t.drawImage(e,this.x,this.y);let i=this.x+this.sliderX;t.drawImage(this.imgLeft,i,this.y),t.drawImage(this.imgNormal,i,this.y);const s=Math.round(this.value/this.max*this.imgHover.width);t.drawImage(this.imgHover,0,0,s,this.imgHover.height,i,this.y,s,this.imgHover.height),i+=this.imgNormal.width,t.drawImage(this.imgRight,i,this.y),super.onRedraw(t)}}class y extends p.H{constructor(t,e){super(t),this.itemsTrigger=[],this.itemsNext=[],this.relX=e.position[0],this.relY=e.position[1],this.menuImage=r.x.getImageOrNull(e.menuImage[0]),this.titleImage=r.x.getBitmapFont(e.menuFont).createTextImage(e.fullName),this.loFont=r.x.getBitmapFont(e.loFont),this.hiFont=r.x.getBitmapFont(e.hiFont),e.itemsLabel.forEach((t=>{const i=this.addChild(new w(this,t,e.autoCenter));"trigger"===t.actionName.toLowerCase()?this.itemsTrigger.push(i):this.itemsNext.push(i)})),e.itemsCycle.forEach((t=>this.addChild(new u(this,t)))),e.itemsSlider.forEach((t=>this.addChild(new x(this,t)))),this.hidden=!0}reset(){super.reset(),this.hidden=!0}onRedraw(t){this.hidden||(t.drawImage(this.menuImage,(d.Du-this.menuImage.width)/2,(d.DG-this.menuImage.height)/2),t.drawImage(this.titleImage,(d.Du-this.titleImage.width)/2,this.y),super.onRedraw(t))}}class v extends a.s{constructor(t,e){super(t),this.layersByKey=new Map,this.hidden=!0,e.menus.forEach(((t,e)=>this.layersByKey.set("menu"+(e+1),this.addChild(new y(this,t))))),this.layersByKey.forEach((t=>t.itemsNext.forEach((t=>t.onClick=()=>this.selectLayer(t.target)))))}reset(){super.reset(),this.hidden=!0}show(){this.hidden=!1,this.selectLayer("menu1")}hide(){super.hide(),this.notifyRedraw()}selectLayer(t){const e=this.layersByKey.get(t.toLowerCase());this.layersByKey.forEach((t=>t!==e&&t.hide())),e.show(),this.notifyRedraw()}}class b extends v{constructor(t,e){super(t,e),this.onRepeatBriefing=()=>console.log("repeat mission briefing"),this.layersByKey.get("menu1").itemsTrigger[0].onClick=()=>this.onRepeatBriefing(),this.layersByKey.get("menu1").itemsTrigger[1].onClick=()=>this.hide()}}class I extends v{constructor(t,e){super(t,e),this.onRepeatBriefing=()=>console.log("repeat mission briefing"),this.onAbortGame=()=>console.log("abort mission"),this.onRestartGame=()=>console.log("restart mission"),this.layersByKey.get("menu1").itemsTrigger[0].onClick=()=>this.hide(),this.layersByKey.get("menu2").itemsTrigger[0].onClick=()=>this.onRepeatBriefing(),this.layersByKey.get("menu3").itemsTrigger[0].onClick=()=>this.onAbortGame(),this.layersByKey.get("menu4").itemsTrigger[0].onClick=()=>this.onRestartGame()}}var R=i(346),P=i(18);class k extends P.x{constructor(t){super(t),this.panelPause=this.addPanel(new I(this.rootElement,r.x.getResource("PausedMenu"))),this.panelOptions=this.addPanel(new b(this.rootElement,r.x.getResource("OptionsMenu"))),this.panelBriefing=this.addPanel(new m(this.rootElement)),this.panelPause.onRepeatBriefing=()=>this.setActivePanel(this.panelBriefing),this.panelOptions.onRepeatBriefing=()=>this.setActivePanel(this.panelBriefing),this.panelBriefing.onSetSpaceToContinue=t=>this.sendResponse({type:R.n.SPACE_TO_CONINUE,messageState:t}),this.panelPause.onAbortGame=()=>this.sendResponse({type:R.n.GAME_ABORT}),this.panelPause.onRestartGame=()=>this.sendResponse({type:R.n.GAME_RESTART})}setCanvas(t){super.setCanvas(t),this.panelPause.width=this.canvas.width,this.panelPause.height=this.canvas.height,this.panelOptions.width=this.canvas.width,this.panelOptions.height=this.canvas.height}onProcessMessage(t){if(t.type===R.n.OVERLAY_SETUP)this.setup(t.objectiveText,t.objectiveBackImgCfg);else{if(t.type!==R.n.SHOW_OPTIONS)return!1;this.panelOptions.show()}return!0}setActivePanel(t){this.panels.forEach((e=>e!==t&&e.hide())),t.show(),this.redraw()}setup(t,e){this.panelBriefing.setup(t,e),d.Sl||this.setActivePanel(this.panelBriefing)}handlePointerEvent(t){return!this.panels.every((t=>t.hidden))&&(super.handlePointerEvent(t)||!0)}handleKeyEvent(t){let e=!1;const i=t.key.toLowerCase();return t.eventEnum===s.Zf.UP&&("escape"===i?this.panelBriefing.hidden&&this.panelOptions.hidden&&(this.panelPause.hidden?this.setActivePanel(this.panelPause):this.panelPause.hide(),e=!0):" "===i&&(this.panelBriefing.hidden||(this.panelBriefing.nextParagraph(),e=!0))),e}}let T=null;const B=self;B.addEventListener("message",(t=>{const e=t.data;e.type===R.n.INIT?(r.x.resourceByName=e.resourceByName,r.x.configuration=e.cfg,r.x.stats=e.stats,T=new k(B)):T.processMessage(e)}))}},s={};function h(t){var e=s[t];if(void 0!==e)return e.exports;var a=s[t]={exports:{}};return i[t](a,a.exports,h),a.exports}h.m=i,h.x=()=>{var t=h.O(void 0,[969],(()=>h(633)));return h.O(t)},t=[],h.O=(e,i,s,a)=>{if(!i){var r=1/0;for(l=0;l<t.length;l++){for(var[i,s,a]=t[l],n=!0,o=0;o<i.length;o++)(!1&a||r>=a)&&Object.keys(h.O).every((t=>h.O[t](i[o])))?i.splice(o--,1):(n=!1,a<r&&(r=a));n&&(t.splice(l--,1),e=s())}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[i,s,a]},h.d=(t,e)=>{for(var i in e)h.o(e,i)&&!h.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},h.f={},h.e=t=>Promise.all(Object.keys(h.f).reduce(((e,i)=>(h.f[i](t,e),e)),[])),h.u=t=>t+".index.js",h.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),h.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;h.g.importScripts&&(t=h.g.location+"");var e=h.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),h.p=t})(),(()=>{var t={633:1};h.f.i=(e,i)=>{t[e]||importScripts(h.p+h.u(e))};var e=self.webpackChunkrock_raiders_web=self.webpackChunkrock_raiders_web||[],i=e.push.bind(e);e.push=e=>{var[s,a,r]=e;for(var n in a)h.o(a,n)&&(h.m[n]=a[n]);for(r&&r(h);s.length;)t[s.pop()]=1;i(e)}})(),e=h.x,h.x=()=>h.e(969).then(e),h.x()})();
//# sourceMappingURL=633.index.js.map
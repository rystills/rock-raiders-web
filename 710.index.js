(self.webpackChunkrock_raiders_web=self.webpackChunkrock_raiders_web||[]).push([[710],{930:(t,e,s)=>{"use strict";s.d(e,{p:()=>i});class i{constructor(){this.buttonType=null,this.normalFile=null,this.highlightFile=null,this.pressedFile=null,this.disabledFile=null,this.relX=0,this.relY=0,this.width=0,this.height=0,this.tooltip=null}}},935:(t,e,s)=>{"use strict";s.d(e,{l:()=>i});class i{static setFromCfg(t,e){return Object.keys(e).forEach((s=>{var i;const n=(s.startsWith("!")?s.substring(1):s).toLowerCase().replace(/_/g,"").replace(/-/g,"");Object.keys(t).some((i=>t.assignValue(i,n,e[s])))||console.warn("cfg key: "+s+" does not exist in cfg: "+(null===(i=null==t?void 0:t.constructor)||void 0===i?void 0:i.name))})),t}assignValue(t,e,s){if(t.toLowerCase()===e){const i=this[t],n=Array.isArray(i);let h=this.parseValue(e,s);const r=Array.isArray(h);return i&&n!==r&&n&&(h=[h]),this[t]=h,!0}}parseValue(t,e){return e}}},234:(t,e,s)=>{"use strict";s.d(e,{l:()=>i});class i{constructor(t){[this.filename,this.xOut,this.yOut,this.xIn,this.yIn]=t}}},538:(t,e,s)=>{"use strict";function i(t,...e){return e.forEach((e=>{t=(t=Object.keys(t).filter((t=>t.toLowerCase()===e.toLowerCase())).map((e=>t[e])))?t[0]:t})),t}function n(t){return t&&clearTimeout(t),null}function h(t){return t&&clearInterval(t),null}s.d(e,{hh:()=>i,L4:()=>n,nJ:()=>h}),Array.prototype.add=function(t){-1===this.indexOf(t)&&this.push(t)},Array.prototype.remove=function(t){const e=this.indexOf(t);-1!==e&&this.splice(e,1)},Array.prototype.removeLast=function(t){const e=this.indexOf(t);-1!==e&&this.splice(e,1)},Array.prototype.last=function(){return this.length>0?this[this.length-1]:void 0},Array.prototype.count=function(t){let e=0;return this.forEach((s=>t(s)&&e++)),e},Array.prototype.partition=function(t){const e=[],s=[];return this.forEach((i=>t(i)?e.push(i):s.push(i))),[e,s]},Array.prototype.random=function(){var t;if(this.length)return this[(t=this.length-1,function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}(0,t))]},Map.prototype.getOrUpdate=function(t,e){let s=this.get(t);return void 0===s&&(s=e(),this.set(t,s)),s},String.prototype.equalsIgnoreCase=function(t){return this.toLowerCase()===(null==t?void 0:t.toLowerCase())}},458:(t,e,s)=>{"use strict";s.d(e,{x:()=>n});var i=s(332);class n extends i.E{}},920:(t,e,s)=>{"use strict";s.d(e,{x:()=>u});var i=s(800),n=s(89),h=s(848),r=s(505),o=s(346);class l extends class{constructor(t){this.messageState=null,this.type=t}}{constructor(t){super(o.n.GAME_EVENT),this.gameEvent=t}}var a=s(360);class u extends class{constructor(t){this.canvas=null,this.context=null,this.eventListener=new Map,this.worker=t}redraw(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}reset(){}setCanvas(t){this.canvas=t,this.context=t.getContext("2d"),this.context.scale(this.canvas.width/h.Du,this.canvas.height/h.DG),this.redraw()}handlePointerEvent(t){return!1}handleKeyEvent(t){return!1}handleWheelEvent(t){return!1}sendResponse(t){this.worker.postMessage(t)}sendEventResponse(t){this.sendResponse(t)}processMessage(t){if(t.type===o.n.CANVAS)this.setCanvas(t.canvas);else if(t.type===o.n.EVENT_POINTER){const e=this.handlePointerEvent(t.inputEvent);this.sendEventResponse({type:o.n.RESPONSE_EVENT,eventId:t.eventId,eventConsumed:e})}else if(t.type===o.n.EVENT_KEY){const e=this.handleKeyEvent(t.inputEvent);this.sendEventResponse({type:o.n.RESPONSE_EVENT,eventId:t.eventId,eventConsumed:e})}else if(t.type===o.n.EVENT_WHEEL){const e=this.handleWheelEvent(t.inputEvent);this.sendEventResponse({type:o.n.RESPONSE_EVENT,eventId:t.eventId,eventConsumed:e})}else if(t.type===o.n.RESET)this.reset();else if(t.type===o.n.REDRAW)this.redraw();else if(t.type===o.n.GAME_EVENT){const e=t.gameEvent;this.eventListener.getOrUpdate(e.eventKey,(()=>[])).forEach((t=>t(e)))}else this.onProcessMessage(t)||console.warn("Worker ignores message of type: "+o.n[t.type]);return!0}publishEvent(t){this.sendResponse(new l(t))}registerEventListener(t,e){this.eventListener.getOrUpdate(t,(()=>[])).push(e)}}{constructor(t){super(t),this.rootElement=new a.H(null),this.panels=[],this.rootElement.notifyRedraw=()=>this.redraw(),this.rootElement.publishEvent=t=>{this.publishEvent(t)},this.rootElement.registerEventListener=(t,e)=>{this.registerEventListener(t,e)}}redraw(){super.redraw(),this.rootElement.onRedraw(this.context)}reset(){super.reset(),this.panels.forEach((t=>t.reset()))}addPanel(t){return this.rootElement.addChild(t),this.panels.push(t),t}handlePointerEvent(t){const[e,s]=[t.canvasX,t.canvasY],[o,l]=[e/(this.canvas.width/h.Du),s/(this.canvas.height/h.DG)].map((t=>Math.round(t))),a=this.context&&this.context.getImageData(e,s,1,1).data[3]>0;return a?(this.publishEvent(new n.RD(r.C.Pointer_Standard)),t.eventEnum===i.iW.MOVE?this.rootElement.checkHover(o,l):t.eventEnum===i.iW.DOWN?this.rootElement.checkClick(o,l,t.button):t.eventEnum===i.iW.UP&&this.rootElement.checkRelease(o,l,t.button)):t.eventEnum===i.iW.MOVE&&this.rootElement.release(),a}handleWheelEvent(t){return!this.context||this.context.getImageData(t.canvasX,t.canvasY,1,1).data[3]>0}}},360:(t,e,s)=>{"use strict";s.d(e,{H:()=>l});var i=s(861),n=s(320),h=s(800),r=s(89),o=s(505);class l{constructor(t){this.parent=null,this.x=0,this.y=0,this.relX=0,this.relY=0,this.width=0,this.height=0,this.children=[],this.hidden=!1,this.disabled=!1,this.hover=!1,this.pressedByButton=null,this.onClick=null,this.onClickSecondary=null,this.onPublishEvent=t=>console.log("TODO publish event: "+n.Z[t.eventKey]),this.tooltipTimeout=null,this.parent=t}reset(){this.hidden=!1,this.disabled=!1,this.hover=!1,this.pressedByButton=null,this.children.forEach((t=>t.reset()))}addChild(t){return t.parent=this,this.children.push(t),t.updatePosition(),t}onRedraw(t){this.hidden||(this.children.forEach((e=>e.onRedraw(t))),this.children.forEach((e=>e.drawHover(t))),this.children.forEach((e=>e.drawTooltip(t))))}drawHover(t){}drawTooltip(t){}isInactive(){for(let t=this.parent;t;t=t.parent)if(t.isInactive())return!0;return this.hidden||this.disabled}hide(){this.hidden=!0,this.children.forEach((t=>t.hide()))}show(){this.hidden=!1,this.children.forEach((t=>t.show()))}updatePosition(){this.x=this.parent?this.parent.x+this.relX:this.relX,this.y=this.parent?this.parent.y+this.relY:this.relY,this.children.forEach((t=>t.updatePosition()))}isInRect(t,e){return t>=this.x&&e>=this.y&&t<this.x+this.width&&e<this.y+this.height}checkHover(t,e){if(this.isInactive())return!1;const s=this.isInRect(t,e);let i=this.hover!==s;return this.hover=s,this.hover?this.tooltipTimeout||(this.tooltipTimeout=setTimeout((()=>this.showTooltip()),1e3)):this.tooltipTimeout&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=null),this.hover||(this.pressedByButton=null),this.children.forEach((s=>i=s.checkHover(t,e)||i)),i}showTooltip(){}checkClick(t,e,s){if(this.isInactive())return!1;const i=this.pressedByButton;this.isInRect(t,e)?null===this.pressedByButton&&(s===h.T.MAIN&&this.onClick||s===h.T.SECONDARY&&this.onClickSecondary)&&(this.pressedByButton=s):this.pressedByButton=null;let n=this.pressedByButton!==i;return this.children.forEach((i=>n=i.checkClick(t,e,s)||n)),n}checkRelease(t,e,s){if(this.isInactive())return!1;this.isInRect(t,e)&&null!==this.pressedByButton&&this.clicked(t,e,s);let i=!1;return this.children.forEach((n=>i=n.checkRelease(t,e,s)||i)),i=null!==this.pressedByButton||i,this.pressedByButton=null,i}clicked(t,e,s){s===h.T.MAIN?this.onClick&&(this.publishEvent(new r.RD(o.C.Pointer_Okay,1e3)),this.publishEvent(new r.s4(i.d.SFX_ButtonPressed)),this.onClick(t,e)):s===h.T.SECONDARY&&this.onClickSecondary&&(this.publishEvent(new r.RD(o.C.Pointer_Okay,1e3)),this.publishEvent(new r.s4(i.d.SFX_ButtonPressed)),this.onClickSecondary(t,e))}release(){let t=null!==this.pressedByButton||this.hover;return this.pressedByButton=null,this.hover=!1,this.children.forEach((e=>t=e.release()||t)),t}notifyRedraw(){var t;null===(t=this.parent)||void 0===t||t.notifyRedraw()}publishEvent(t){this.parent?this.parent.publishEvent(t):this.onPublishEvent(t)}registerEventListener(t,e){this.parent.registerEventListener(t,e)}}},211:(t,e,s)=>{"use strict";s.d(e,{z:()=>r});var i=s(768),n=s(458),h=s(360);class r extends h.H{constructor(t,e){var s,i,h,r,o,l,a;super(t),this.buttonType=null,this.sfxName=null,this.imgNormal=null,this.imgHover=null,this.imgPressed=null,this.imgDisabled=null,this.tooltip=null,this.sfxTooltip=null,Array.isArray(e.buttonType)?[this.buttonType,this.sfxName]=e.buttonType:this.buttonType=e.buttonType,this.imgNormal=n.x.getImageOrNull(e.normalFile),this.imgHover=n.x.getImageOrNull(e.highlightFile),this.imgPressed=n.x.getImageOrNull(e.pressedFile),this.imgDisabled=n.x.getImageOrNull(e.disabledFile),this.relX=e.relX,this.relY=e.relY,this.width=e.width||(null===(s=this.imgNormal)||void 0===s?void 0:s.width)||(null===(i=this.imgPressed)||void 0===i?void 0:i.width)||(null===(h=this.imgHover)||void 0===h?void 0:h.width),this.height=e.height||(null===(r=this.imgNormal)||void 0===r?void 0:r.height)||(null===(o=this.imgPressed)||void 0===o?void 0:o.height)||(null===(l=this.imgHover)||void 0===l?void 0:l.height),Array.isArray(e.tooltip)?[this.tooltip,this.sfxTooltip]=e.tooltip:this.tooltip=e.tooltip,this.tooltip=null===(a=this.tooltip)||void 0===a?void 0:a.replace(/_/g," "),this.updatePosition(),this.onClick=()=>console.log("button pressed: "+this.buttonType)}showTooltip(){this.sfxName&&i.P.playSound(this.sfxName),this.sfxTooltip&&i.P.playSound(this.sfxTooltip)}checkHover(t,e){const s=super.checkHover(t,e);return s&&this.notifyRedraw(),s}checkClick(t,e,s){const i=super.checkClick(t,e,s);return i&&this.notifyRedraw(),i}checkRelease(t,e,s){const i=super.checkRelease(t,e,s);return i&&this.notifyRedraw(),i}release(){const t=super.release();return t&&this.notifyRedraw(),t}onRedraw(t){if(this.hidden)return;let e=this.imgNormal;this.disabled?e=this.imgDisabled||this.imgPressed||this.imgNormal:null!==this.pressedByButton?e=this.imgPressed||this.imgNormal:this.hover&&(e=this.imgHover||this.imgNormal),e&&t.drawImage(e,this.x,this.y),super.onRedraw(t)}}},670:(t,e,s)=>{"use strict";s.d(e,{s:()=>o});var i=s(538),n=s(848),h=s(458),r=s(360);class o extends r.H{constructor(t,e){super(t),this.img=null,this.xOut=0,this.yOut=0,this.xIn=0,this.yIn=0,this.animationTimeout=null,this.movedIn=!0,e&&(this.img=h.x.getImage(e.filename),this.xOut=e.xOut,this.yOut=e.yOut,this.xIn=e.xIn,this.yIn=e.yIn,this.relX=this.xIn,this.relY=this.yIn)}reset(){super.reset(),this.animationTimeout=(0,i.L4)(this.animationTimeout),this.relX=this.xIn,this.relY=this.yIn,this.movedIn=!0,this.updatePosition()}isInactive(){return this.animationTimeout||super.isInactive()}setMovedIn(t,e=null){this.movedIn!==t?this.toggleState(e):e&&e()}toggleState(t=null){this.animationTimeout=(0,i.L4)(this.animationTimeout),this.movedIn?(this.movedIn=!1,this.updateAnimation(this.xOut,this.yOut,n.CM,t)):(this.movedIn=!0,this.updateAnimation(this.xIn,this.yIn,n.CM,t))}updateAnimation(t,e,s,i){const h=t-this.relX,r=e-this.relY;if(Math.abs(h)<=s&&Math.abs(r)<=s)this.relX=t,this.relY=e,this.animationTimeout=null,i&&i();else{this.relX+=Math.round(Math.sign(h)*Math.sqrt(Math.abs(h))*s),this.relY+=Math.round(Math.sign(r)*Math.sqrt(Math.abs(r))*s);const o=this;this.animationTimeout=setTimeout((()=>o.updateAnimation(t,e,s,i)),1e3/n.OK)}this.updatePosition(),this.notifyRedraw()}onRedraw(t){this.hidden||(this.img&&t.drawImage(this.img,this.x,this.y),super.onRedraw(t))}}}}]);
//# sourceMappingURL=710.index.js.map